<!--
  Lightweight chat widget demonstrating SSE streaming from /api/v1/llm/chat.
  Copy this file into another app and change the EventSource URL as needed.
-->
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <title>LLM Chat Widget</title>
  <style>
    :root {
      /* Dark Theme - Premium Evolution */
      --bg: linear-gradient(135deg, #0a0e1a 0%, #0f1419 100%);
      --bg-solid: #0a0e1a;
      --panel: rgba(23, 28, 38, 0.85);
      --panel-hover: rgba(30, 36, 48, 0.92);
      --border: rgba(79, 124, 255, 0.15);
      --border-hover: rgba(79, 124, 255, 0.35);
      --text: #f8fafc;
      --text-secondary: #cbd5e1;
      --muted: #94a3b8;
      --accent: #4f91ff;
      --accent-hover: #6ba3ff;
      --accent-glow: rgba(79, 145, 255, 0.25);
      --error: #ff5d5d;
      --error-glow: rgba(255, 93, 93, 0.2);
      --ok: #32d296;
      --ok-glow: rgba(50, 210, 150, 0.2);
      --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.15);
      --shadow-md: 0 8px 24px rgba(0, 0, 0, 0.25);
      --shadow-lg: 0 16px 48px rgba(0, 0, 0, 0.35);
      --shadow-xl: 0 24px 64px rgba(0, 0, 0, 0.45);
      --blur: blur(12px);
      --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    [data-theme='light'] {
      /* Light Theme - Clean & Professional */
      --bg: linear-gradient(135deg, #fafbfd 0%, #f8f9fb 100%);
      --bg-solid: #fafbfd;
      --panel: rgba(255, 255, 255, 0.95);
      --panel-hover: rgba(255, 255, 255, 1);
      --border: rgba(37, 99, 235, 0.12);
      --border-hover: rgba(37, 99, 235, 0.25);
      --text: #1e293b;
      --text-secondary: #475569;
      --muted: #64748b;
      --accent: #2563eb;
      --accent-hover: #3b82f6;
      --accent-glow: rgba(37, 99, 235, 0.15);
      --error: #dc2626;
      --error-glow: rgba(220, 38, 38, 0.15);
      --ok: #16a34a;
      --ok-glow: rgba(22, 163, 74, 0.15);
      --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.08);
      --shadow-md: 0 4px 16px rgba(0, 0, 0, 0.08);
      --shadow-lg: 0 12px 32px rgba(0, 0, 0, 0.1);
      --shadow-xl: 0 20px 48px rgba(0, 0, 0, 0.12);
      --blur: blur(8px);
      --transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
    }

    * {
      box-sizing: border-box;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      margin: 0;
      background: var(--bg-solid);
      background-image: var(--bg);
      color: var(--text);
      transition: background-color 0.3s ease, color 0.3s ease;
      line-height: 1.6;
    }

    body.embed {
      background: transparent;
    }

    .widget-launcher {
      position: fixed;
      display: none;
      align-items: center;
      gap: 12px;
      background: var(--panel);
      backdrop-filter: var(--blur);
      color: var(--text);
      border: 1px solid var(--border);
      border-radius: 999px;
      padding: 12px 18px;
      box-shadow: var(--shadow-lg), 0 0 0 1px var(--accent-glow);
      cursor: pointer;
      transition: var(--transition);
      z-index: 9999;
    }

    .widget-launcher[data-position="bottom-right"],
    .widget-launcher.pos-bottom-right {
      right: 24px;
      bottom: 24px;
    }

    .widget-launcher[data-position="bottom-left"],
    .widget-launcher.pos-bottom-left {
      left: 24px;
      bottom: 24px;
    }

    .widget-launcher[data-position="top-right"],
    .widget-launcher.pos-top-right {
      right: 24px;
      top: 24px;
    }

    .widget-launcher[data-position="top-left"],
    .widget-launcher.pos-top-left {
      left: 24px;
      top: 24px;
    }

    body.embed .widget-launcher {
      display: inline-flex;
    }

    .widget-launcher:hover {
      transform: translateY(-3px) scale(1.02);
      box-shadow: var(--shadow-xl), 0 0 0 1px var(--accent-glow), 0 0 24px var(--accent-glow);
      border-color: var(--border-hover);
      background: var(--panel-hover);
    }

    .launcher-avatar {
      background: var(--accent);
      color: #fff;
      width: 36px;
      height: 36px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      font-weight: 600;
    }

    .launcher-text {
      display: flex;
      flex-direction: column;
      line-height: 1.15;
    }

    .launcher-text strong {
      font-size: 14px;
      letter-spacing: 0.04em;
    }

    .launcher-text span {
      font-size: 12px;
      color: var(--muted);
    }

    .chat-backdrop {
      position: fixed;
      inset: 0;
      background: rgba(6, 10, 22, 0.65);
      backdrop-filter: blur(2px);
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.2s ease;
      z-index: 9998;
    }

    .chat-backdrop.open {
      opacity: 1;
      pointer-events: auto;
    }

    .chat-modal {
      position: fixed;
      inset: 0;
      display: none;
      align-items: center;
      justify-content: center;
      padding: 24px;
      z-index: 10000;
    }

    .chat-modal.open {
      display: flex;
    }

    .chat-window {
      width: min(420px, calc(100vw - 32px));
      max-height: calc(100vh - 48px);
      background: var(--panel);
      backdrop-filter: var(--blur);
      border-radius: 24px;
      border: 1px solid var(--border);
      box-shadow: var(--shadow-xl), 0 0 0 1px var(--accent-glow);
      display: flex;
      flex-direction: column;
      overflow: hidden;
      animation: slideIn 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(20px) scale(0.95);
      }

      to {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
    }

    .chat-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 14px 18px;
      border-bottom: 1px solid var(--border);
      background: rgba(255, 255, 255, 0.02);
    }

    .chat-title {
      font-weight: 600;
      letter-spacing: 0.04em;
      text-transform: uppercase;
      font-size: 13px;
    }

    .chat-subtitle {
      font-size: 11px;
      color: var(--muted);
      margin-top: 2px;
    }

    .chat-close {
      background: none;
      border: none;
      color: var(--muted);
      font-size: 20px;
      cursor: pointer;
      width: 32px;
      height: 32px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background 0.15s ease, color 0.15s ease;
    }

    .chat-close:hover {
      background: rgba(96, 165, 250, 0.12);
      color: var(--accent);
    }

    .chat-body {
      flex: 1 1 auto;
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }

    .container {
      max-width: 860px;
      margin: 0 auto;
      padding: 16px;
    }

    .chat-body .container {
      flex: 1 1 auto;
      display: flex;
      flex-direction: column;
    }

    .toolbar {
      display: flex;
      gap: 8px;
      align-items: center;
      margin-bottom: 12px;
      flex-wrap: wrap;
    }

    .toolbar .spacer {
      flex: 1 1 auto;
    }

    .toolbar input[type=text] {
      background: var(--panel);
      border: 1px solid var(--border);
      color: var(--text);
      padding: 8px 10px;
      border-radius: 6px;
      flex: 1 1 280px;
    }

    .toolbar select {
      background: var(--panel);
      border: 1px solid var(--border);
      color: var(--text);
      padding: 8px 10px;
      border-radius: 6px;
      min-width: 120px;
    }

    .toolbar button {
      background: var(--panel);
      border: 1px solid var(--border);
      color: var(--text);
      padding: 8px 10px;
      border-radius: 6px;
      cursor: pointer;
    }

    .toolbar button:hover {
      border-color: var(--accent);
    }

    .visually-hidden {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0, 0, 0, 0);
      border: 0;
    }

    .status {
      font-size: 12px;
      color: var(--muted);
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      display: inline-block;
      background: var(--muted);
    }

    .dot.ok {
      background: var(--ok);
    }

    .dot.bad {
      background: var(--error);
    }

    #messages {
      border: 1px solid var(--border);
      background: var(--panel);
      border-radius: 8px;
      padding: 12px;
      height: 360px;
      overflow-y: auto;
      margin-bottom: 12px;
    }

    .msg {
      margin: 8px 0;
      line-height: 1.55;
    }

    .msg .role {
      font-size: 12px;
      color: var(--muted);
      margin-bottom: 4px;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .msg .time {
      opacity: 0.85;
      font-variant-numeric: tabular-nums;
    }

    .msg.user {
      color: #9cc9ff;
    }

    .msg.assistant {
      color: #b8e994;
    }

    .msg.debug {
      color: #facc15;
    }

    .msg .msg-body {
      white-space: pre-wrap;
    }

    .msg-attachments {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-top: 6px;
    }

    .msg-attachments .attachment-item {
      display: inline-flex;
      flex-direction: column;
      gap: 4px;
      background: rgba(96, 165, 250, 0.12);
      padding: 6px 8px;
      border-radius: 10px;
      max-width: 200px;
    }

    .msg-attachments .attachment-file a {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      color: #bfdbfe;
      font-size: 12px;
      text-decoration: none;
    }

    .msg-attachments .attachment-file a::before {
      content: '\1F4CE';
    }

    .msg-attachments .attachment-image {
      background: rgba(59, 130, 246, 0.12);
    }

    .msg-attachments .attachment-image img {
      display: block;
      max-width: 180px;
      border-radius: 8px;
    }

    .msg-attachments .attachment-caption {
      font-size: 11px;
      color: var(--muted);
    }

    .msg-sources {
      margin-top: 6px;
      display: flex;
      flex-direction: column;
      gap: 4px;
      font-size: 12px;
    }

    .msg-sources-list {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .msg-sources a {
      color: var(--accent);
      text-decoration: none;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .msg-sources a::before {
      content: '\1F517';
      font-size: 12px;
    }

    .msg-sources a:hover {
      text-decoration: underline;
    }

    form {
      display: grid;
      grid-template-columns: 1fr auto auto;
      gap: 8px;
      align-items: start;
    }

    textarea {
      background: var(--panel);
      backdrop-filter: var(--blur);
      border: 1px solid var(--border);
      color: var(--text);
      padding: 12px 14px;
      border-radius: 12px;
      min-height: 56px;
      resize: vertical;
      transition: var(--transition);
      font-family: inherit;
      font-size: 14px;
    }

    textarea:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 3px var(--accent-glow), var(--shadow-md);
    }

    .btn {
      background: linear-gradient(135deg, var(--accent) 0%, var(--accent-hover) 100%);
      border: none;
      color: white;
      padding: 12px 20px;
      border-radius: 12px;
      cursor: pointer;
      font-weight: 500;
      font-size: 14px;
      letter-spacing: 0.02em;
      box-shadow: var(--shadow-md), 0 0 0 1px var(--accent-glow);
      transition: var(--transition);
    }

    .btn:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-lg), 0 0 24px var(--accent-glow);
    }

    .btn:active {
      transform: translateY(0);
    }

    .btn.secondary {
      background: var(--panel);
      backdrop-filter: var(--blur);
      border: 1px solid var(--border);
      color: var(--text);
      box-shadow: var(--shadow-sm);
    }

    .btn.secondary:hover {
      border-color: var(--border-hover);
      background: var(--panel-hover);
    }

    .download-section {
      padding: 48px 36px;
      background: var(--panel);
      border-radius: 20px;
      border: 1px solid var(--border);
      margin: 48px 0;
      box-shadow: 0 32px 70px rgba(8, 13, 26, 0.45);
    }

    .download-section h2 {
      font-size: 28px;
      margin-bottom: 12px;
      letter-spacing: -0.01em;
    }

    .download-section p {
      margin: 0 0 24px;
      color: var(--muted);
      line-height: 1.6;
    }

    .download-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
      gap: 18px;
    }

    .download-card {
      padding: 18px;
      border-radius: 18px;
      border: 1px solid rgba(79, 124, 255, 0.25);
      background: rgba(79, 124, 255, 0.08);
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .download-card h3 {
      margin: 0;
      font-size: 18px;
    }

    .download-card p {
      margin: 0;
      color: rgba(226, 232, 240, 0.8);
    }

    .download-card .btn.secondary {
      margin-left: 0;
    }

    .download-links {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
    }

    .download-note {
      margin-top: 16px;
      padding: 12px 14px;
      border-radius: 12px;
      border: 1px dashed rgba(148, 163, 184, 0.35);
      font-size: 13px;
      color: rgba(226, 232, 240, 0.75);
    }

    .embed-position-picker {
      display: grid;
      gap: 10px;
      align-content: start;
    }

    .embed-position-label {
      font-size: 12px;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      color: var(--muted);
    }

    .embed-position-preview {
      position: relative;
      width: 160px;
      height: 120px;
      border-radius: 14px;
      border: 1px solid var(--border);
      background: linear-gradient(160deg, rgba(79, 124, 255, 0.06), rgba(15, 17, 23, 0.2));
      box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.05);
      overflow: hidden;
    }

    .embed-position-preview::after {
      content: '';
      position: absolute;
      inset: 12px;
      border-radius: 10px;
      border: 1px dashed rgba(148, 163, 184, 0.35);
      pointer-events: none;
    }

    .embed-position-preview button.embed-position-zone {
      position: absolute;
      width: 50%;
      height: 50%;
      border: none;
      background: transparent;
      cursor: pointer;
      outline: none;
    }

    .embed-position-preview button.embed-position-zone[data-position-option="top-left"] {
      top: 0;
      left: 0;
    }

    .embed-position-preview button.embed-position-zone[data-position-option="top-right"] {
      top: 0;
      right: 0;
    }

    .embed-position-preview button.embed-position-zone[data-position-option="bottom-left"] {
      bottom: 0;
      left: 0;
    }

    .embed-position-preview button.embed-position-zone[data-position-option="bottom-right"] {
      bottom: 0;
      right: 0;
    }

    .embed-position-preview button.embed-position-zone:focus-visible {
      box-shadow: inset 0 0 0 2px rgba(79, 124, 255, 0.6);
    }

    .embed-position-preview button.embed-position-zone[data-active="true"]::after {
      content: '';
      position: absolute;
      inset: 6px;
      border-radius: 10px;
      border: 1px solid rgba(79, 124, 255, 0.45);
      background: rgba(79, 124, 255, 0.08);
      pointer-events: none;
    }

    .embed-position-marker {
      position: absolute;
      width: 42px;
      height: 42px;
      border-radius: 999px;
      background: var(--accent);
      color: #fff;
      display: grid;
      place-items: center;
      font-size: 14px;
      font-weight: 600;
      letter-spacing: 0.05em;
      box-shadow: 0 14px 24px rgba(79, 124, 255, 0.35);
      transition: all 0.2s ease;
    }

    .embed-position-preview[data-position="top-left"] .embed-position-marker {
      top: 18px;
      left: 18px;
    }

    .embed-position-preview[data-position="top-right"] .embed-position-marker {
      top: 18px;
      right: 18px;
    }

    .embed-position-preview[data-position="bottom-left"] .embed-position-marker {
      bottom: 18px;
      left: 18px;
    }

    .embed-position-preview[data-position="bottom-right"] .embed-position-marker {
      bottom: 18px;
      right: 18px;
    }

    .embed-position-helper {
      font-size: 11px;
      color: var(--muted);
      letter-spacing: 0.04em;
    }

    .download-status {
      margin-top: 8px;
      font-size: 13px;
      color: var(--muted);
    }

    .download-status[data-state="success"] {
      color: var(--ok);
    }

    .download-status[data-state="error"] {
      color: var(--error);
    }

    body.modal-open {
      overflow: hidden;
    }

    .auth-modal {
      position: fixed;
      inset: 0;
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 1200;
    }

    .auth-modal[data-visible="true"] {
      display: flex;
    }

    .auth-modal .auth-backdrop {
      position: absolute;
      inset: 0;
      background: rgba(11, 17, 33, 0.72);
      backdrop-filter: blur(6px);
    }

    .auth-modal .auth-card {
      position: relative;
      width: min(420px, 92%);
      background: rgba(15, 23, 42, 0.94);
      border-radius: 18px;
      border: 1px solid rgba(148, 163, 184, 0.28);
      box-shadow: 0 28px 68px rgba(6, 10, 24, 0.55);
      padding: 28px;
      color: var(--text-primary);
      display: flex;
      flex-direction: column;
      gap: 18px;
      z-index: 1;
    }

    .auth-modal h3 {
      margin: 0;
      font-size: 20px;
      letter-spacing: 0.05em;
      text-transform: uppercase;
    }

    .auth-modal p {
      margin: 0;
      font-size: 14px;
      color: var(--text-muted);
    }

    .auth-form {
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    .auth-form label {
      display: flex;
      flex-direction: column;
      gap: 6px;
      font-size: 12px;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      color: rgba(203, 213, 225, 0.86);
    }

    .auth-form input {
      border-radius: 12px;
      border: 1px solid rgba(96, 112, 152, 0.45);
      background: rgba(12, 19, 34, 0.8);
      color: var(--text-primary);
      padding: 10px 12px;
      font-size: 14px;
    }

    .auth-form input:focus {
      outline: none;
      border-color: rgba(96, 165, 250, 0.65);
      box-shadow: 0 0 0 2px rgba(96, 165, 250, 0.25);
    }

    .auth-error {
      min-height: 18px;
      font-size: 13px;
      color: var(--danger);
    }

    .auth-actions {
      display: flex;
      justify-content: flex-end;
      gap: 12px;
    }

    .auth-actions .btn.secondary {
      color: var(--text-muted);
      border-color: rgba(148, 163, 184, 0.35);
      background: rgba(15, 23, 42, 0.6);
    }

    .auth-actions .btn.secondary:hover {
      border-color: rgba(96, 165, 250, 0.55);
      color: var(--text-primary);
    }

    .muted {
      color: var(--muted);
      font-size: 12px;
    }

    .project-panel {
      border: 1px solid var(--border);
      background: var(--panel);
      border-radius: 8px;
      padding: 12px;
      margin-bottom: 12px;
      display: grid;
      gap: 12px;
    }

    .project-panel label {
      font-size: 12px;
      color: var(--muted);
      display: block;
      margin-bottom: 4px;
    }

    .project-panel select,
    .project-panel textarea {
      width: 100%;
      background: var(--bg);
      border: 1px solid var(--border);
      color: var(--text);
      border-radius: 6px;
      padding: 8px 10px;
    }

    .project-panel select {
      min-height: 36px;
    }

    .project-panel textarea {
      min-height: 80px;
      resize: vertical;
    }

    .project-panel .row {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      align-items: center;
    }

    .project-panel .row>* {
      flex: 0 0 auto;
    }

    .project-panel .grow {
      flex: 1 1 auto;
    }

    .project-panel .actions {
      display: flex;
      gap: 8px;
      align-items: center;
    }

    .project-panel .checkbox {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      cursor: pointer;
      font-size: 14px;
      color: var(--text);
    }

    .project-panel .checkbox input {
      width: 16px;
      height: 16px;
    }

    @keyframes heroGlow {
      0% {
        transform: translate3d(0, 0, 0) scale(1);
        opacity: 0.9;
      }

      50% {
        transform: translate3d(6px, -6px, 0) scale(1.05);
        opacity: 1;
      }

      100% {
        transform: translate3d(0, 0, 0) scale(1);
        opacity: 0.9;
      }
    }

    @keyframes orbitPulse {
      0% {
        transform: rotate(0deg) scale(0.95);
        opacity: 0.6;
      }

      50% {
        transform: rotate(12deg) scale(1.05);
        opacity: 0.9;
      }

      100% {
        transform: rotate(0deg) scale(0.95);
        opacity: 0.6;
      }
    }

    @keyframes badgeFloat {
      0% {
        transform: translateY(0px);
      }

      50% {
        transform: translateY(-8px);
      }

      100% {
        transform: translateY(0px);
      }
    }

    @keyframes pulseRing {
      0% {
        transform: scale(0.85);
        opacity: 0.25;
      }

      70% {
        transform: scale(1.18);
        opacity: 0.05;
      }

      100% {
        transform: scale(0.85);
        opacity: 0;
      }
    }

    .page-shell {
      max-width: 1100px;
      margin: 0 auto;
      padding: 48px 24px 32px;
      display: grid;
      gap: 64px;
    }

    body.embed .page-shell {
      display: none;
    }

    .hero {
      position: relative;
      overflow: hidden;
      border: 1px solid rgba(148, 163, 184, 0.25);
      border-radius: 32px;
      background: radial-gradient(circle at 20% 20%, rgba(79, 124, 255, 0.2), transparent 60%),
        linear-gradient(150deg, rgba(79, 124, 255, 0.16), rgba(6, 12, 24, 0.8));
      padding: 72px 24px 64px;
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      gap: 48px;
      align-items: center;
    }

    .hero::after {
      content: '';
      position: absolute;
      inset: 12px;
      border-radius: 28px;
      border: 1px solid rgba(79, 124, 255, 0.18);
      pointer-events: none;
    }

    .hero-copy {
      position: relative;
      z-index: 2;
      display: grid;
      gap: 18px;
    }

    .hero-title {
      margin: 0;
      font-size: clamp(32px, 5vw, 48px);
      line-height: 1.08;
      letter-spacing: -0.02em;
      color: #f8fafc;
    }

    .hero-lead {
      margin: 0;
      color: rgba(226, 232, 240, 0.82);
      font-size: 18px;
      line-height: 1.6;
    }

    .hero-actions {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      align-items: center;
    }

    .hero-cta {
      background: var(--accent);
      border: none;
      color: #fff;
      padding: 14px 22px;
      border-radius: 999px;
      font-size: 15px;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      cursor: pointer;
      box-shadow: 0 18px 40px rgba(79, 124, 255, 0.35);
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .hero-cta:hover {
      transform: translateY(-2px);
      box-shadow: 0 24px 48px rgba(79, 124, 255, 0.45);
    }

    .hero-link {
      color: rgba(226, 232, 240, 0.82);
      text-decoration: none;
      font-size: 14px;
      letter-spacing: 0.06em;
      text-transform: uppercase;
    }

    .hero-link:hover {
      color: #fff;
    }

    .hero-visual {
      position: relative;
      justify-self: center;
      width: min(360px, 100%);
      aspect-ratio: 1;
      display: grid;
      place-items: center;
    }

    .hero-orb {
      position: absolute;
      inset: 18%;
      border-radius: 50%;
      background: radial-gradient(circle at 30% 30%, rgba(248, 250, 252, 0.72), rgba(79, 124, 255, 0.95));
      filter: drop-shadow(0 24px 60px rgba(79, 124, 255, 0.4));
      animation: heroGlow 8s ease-in-out infinite;
    }

    .hero-ring {
      position: absolute;
      inset: 4%;
      border-radius: 50%;
      border: 1px solid rgba(148, 163, 184, 0.25);
      animation: orbitPulse 9s ease-in-out infinite;
    }

    .hero-badge {
      position: relative;
      z-index: 3;
      width: 96px;
      height: 96px;
      border-radius: 28px;
      background: rgba(15, 23, 42, 0.75);
      color: #fff;
      font-size: 28px;
      font-weight: 700;
      display: grid;
      place-items: center;
      letter-spacing: 0.1em;
      animation: badgeFloat 4.5s ease-in-out infinite;
      box-shadow: 0 18px 36px rgba(15, 23, 42, 0.45);
    }

    .hero-pulse {
      position: absolute;
      inset: 12%;
      border-radius: 50%;
      border: 2px solid rgba(79, 124, 255, 0.45);
      animation: pulseRing 4s linear infinite;
    }

    .section-header {
      display: grid;
      gap: 12px;
      margin-bottom: 24px;
    }

    .section-title {
      margin: 0;
      font-size: 28px;
      letter-spacing: -0.01em;
      color: var(--text);
    }

    .section-lead {
      margin: 0;
      color: var(--muted);
      font-size: 16px;
      max-width: 680px;
    }

    .embed-section,
    .voice-section {
      border: 1px solid var(--border);
      border-radius: 24px;
      padding: 32px;
      background: linear-gradient(160deg, rgba(79, 124, 255, 0.08), rgba(15, 17, 23, 0.68));
      backdrop-filter: blur(8px);
    }

    .embed-tabs {
      display: inline-flex;
      gap: 8px;
      flex-wrap: wrap;
      margin-bottom: 18px;
    }

    .embed-tab {
      background: rgba(15, 17, 23, 0.35);
      border: 1px solid rgba(148, 163, 184, 0.25);
      color: rgba(226, 232, 240, 0.85);
      border-radius: 999px;
      padding: 8px 16px;
      font-size: 13px;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      cursor: pointer;
      transition: border 0.2s ease, background 0.2s ease, color 0.2s ease;
    }

    .embed-tab.active {
      background: rgba(79, 124, 255, 0.18);
      border-color: rgba(79, 124, 255, 0.55);
      color: #fff;
      box-shadow: 0 10px 28px rgba(79, 124, 255, 0.28);
    }

    .embed-controls {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 16px;
      margin-bottom: 20px;
    }

    .embed-controls label {
      display: grid;
      gap: 6px;
      font-size: 12px;
      color: var(--muted);
      letter-spacing: 0.04em;
      text-transform: uppercase;
    }

    .embed-reading {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 12px;
      color: var(--muted);
      letter-spacing: 0.04em;
      text-transform: uppercase;
    }

    .embed-reading input {
      width: auto;
      accent-color: var(--accent);
    }

    .embed-controls input,
    .embed-controls select {
      background: rgba(15, 17, 23, 0.55);
      border: 1px solid rgba(148, 163, 184, 0.25);
      color: var(--text);
      border-radius: 10px;
      padding: 10px 12px;
      font-size: 14px;
    }

    .code-card {
      position: relative;
      border-radius: 18px;
      border: 1px solid rgba(148, 163, 184, 0.25);
      background: rgba(9, 11, 19, 0.78);
      padding: 18px;
      overflow-x: auto;
      font-family: "JetBrains Mono", "Fira Code", Menlo, Consolas, monospace;
      font-size: 13px;
      line-height: 1.6;
    }

    .code-card pre {
      margin: 0;
      white-space: pre;
    }

    .copy-btn {
      position: absolute;
      right: 16px;
      top: 16px;
      background: rgba(79, 124, 255, 0.16);
      border: 1px solid rgba(79, 124, 255, 0.4);
      color: rgba(226, 232, 240, 0.9);
      font-size: 12px;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      border-radius: 999px;
      padding: 6px 12px;
      cursor: pointer;
      transition: background 0.2s ease, transform 0.2s ease;
    }

    .copy-btn:hover {
      background: rgba(79, 124, 255, 0.28);
      transform: translateY(-1px);
    }

    .copy-btn.copied {
      background: rgba(34, 197, 94, 0.22);
      border-color: rgba(34, 197, 94, 0.5);
      color: #bbf7d0;
    }

    .copy-btn:disabled {
      opacity: 0.4;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }

    .voice-layout {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      gap: 24px;
      align-items: start;
    }

    .voice-preview {
      min-height: 260px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .voice-controls {
      display: grid;
      gap: 16px;
    }

    .voice-mode-select {
      display: grid;
      gap: 8px;
    }

    .voice-mode-label {
      font-size: 12px;
      color: var(--muted);
      letter-spacing: 0.04em;
      text-transform: uppercase;
    }

    .voice-mode-options {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }

    .voice-mode-option {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 10px 14px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.25);
      background: rgba(15, 17, 23, 0.55);
      color: var(--text);
      font-size: 13px;
      cursor: pointer;
      transition: background 0.2s ease, border-color 0.2s ease, color 0.2s ease, transform 0.2s ease;
    }

    .voice-mode-option input {
      display: none;
    }

    .voice-mode-option.is-active {
      background: rgba(79, 124, 255, 0.18);
      border-color: rgba(79, 124, 255, 0.55);
      color: #e0e7ff;
      box-shadow: 0 10px 24px rgba(79, 124, 255, 0.18);
    }

    .voice-mode-option.is-disabled {
      opacity: 0.55;
      cursor: not-allowed;
    }

    .voice-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 14px;
    }

    .voice-grid label {
      display: grid;
      gap: 6px;
      font-size: 12px;
      color: var(--muted);
      letter-spacing: 0.04em;
      text-transform: uppercase;
    }

    .voice-grid input {
      background: rgba(15, 17, 23, 0.55);
      border: 1px solid rgba(148, 163, 184, 0.25);
      color: var(--text);
      border-radius: 10px;
      padding: 10px 12px;
      font-size: 14px;
    }

    .voice-grid.is-disabled input {
      opacity: 0.4;
      cursor: not-allowed;
    }

    .voice-choice {
      position: relative;
    }

    .voice-choice input {
      width: 100%;
    }

    .avatar-character-panel {
      display: grid;
      gap: 12px;
    }

    .avatar-character-panel[hidden] {
      display: none;
    }

    .avatar-character-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 10px;
    }

    .avatar-character-card {
      display: grid;
      gap: 4px;
      padding: 12px 14px;
      border-radius: 14px;
      border: 1px solid rgba(148, 163, 184, 0.25);
      background: rgba(15, 17, 23, 0.55);
      color: var(--text);
      text-align: left;
      cursor: pointer;
      transition: transform 0.2s ease, border-color 0.2s ease, background 0.2s ease;
      font-size: 13px;
    }

    .avatar-character-card:hover {
      transform: translateY(-1px);
      border-color: rgba(79, 124, 255, 0.45);
    }

    .avatar-character-card.is-active {
      border-color: rgba(79, 124, 255, 0.6);
      background: rgba(79, 124, 255, 0.18);
      box-shadow: 0 12px 24px rgba(79, 124, 255, 0.18);
    }

    .avatar-character-name {
      font-weight: 600;
      letter-spacing: 0.02em;
    }

    .avatar-character-desc {
      font-size: 12px;
      color: var(--muted);
      line-height: 1.4;
    }

    .voice-tuning {
      display: grid;
      gap: 12px;
    }

    .voice-speed {
      display: grid;
      gap: 6px;
      font-size: 12px;
      color: var(--muted);
      letter-spacing: 0.04em;
      text-transform: uppercase;
    }

    .voice-speed input[type="range"] {
      width: 100%;
      accent-color: rgba(79, 124, 255, 0.8);
    }

    .voice-speed output {
      justify-self: flex-start;
      font-size: 12px;
      color: var(--text);
      background: rgba(79, 124, 255, 0.18);
      border-radius: 999px;
      padding: 4px 10px;
      letter-spacing: 0.04em;
    }

    .voice-test {
      display: grid;
      gap: 8px;
    }

    .voice-test textarea {
      width: 100%;
      min-height: 64px;
      border-radius: 12px;
      border: 1px solid rgba(148, 163, 184, 0.25);
      background: rgba(15, 17, 23, 0.55);
      color: var(--text);
      padding: 10px 12px;
      font-size: 13px;
      resize: vertical;
    }

    .voice-test button {
      justify-self: flex-start;
      padding: 8px 14px;
      border-radius: 999px;
      border: 1px solid rgba(79, 124, 255, 0.45);
      background: rgba(79, 124, 255, 0.18);
      color: var(--text);
      font-size: 12px;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      cursor: pointer;
      transition: background 0.2s ease, border-color 0.2s ease;
    }

    .voice-test button:hover {
      background: rgba(79, 124, 255, 0.28);
      border-color: rgba(79, 124, 255, 0.65);
    }

    .developer-credit {
      display: block;
      margin: 32px auto 12px;
      text-align: center;
      font-size: 11px;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      color: rgba(226, 232, 240, 0.45);
      text-decoration: none;
      transition: color 0.2s ease;
    }

    .developer-credit:hover {
      color: rgba(226, 232, 240, 0.75);
    }

    .feedback-trigger {
      position: fixed;
      left: 24px;
      bottom: 24px;
      z-index: 9999;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 10px 14px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.3);
      background: rgba(15, 17, 23, 0.6);
      color: rgba(226, 232, 240, 0.78);
      font-size: 12px;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      cursor: pointer;
      backdrop-filter: blur(6px);
      transition: background 0.2s ease, color 0.2s ease;
    }

    .feedback-trigger:hover {
      background: rgba(79, 124, 255, 0.18);
      color: #fff;
    }

    .feedback-panel {
      position: fixed;
      left: 24px;
      bottom: 80px;
      width: min(320px, calc(100vw - 40px));
      background: rgba(12, 15, 24, 0.92);
      border: 1px solid rgba(148, 163, 184, 0.3);
      border-radius: 16px;
      box-shadow: 0 20px 48px rgba(15, 23, 42, 0.45);
      padding: 18px;
      color: rgba(226, 232, 240, 0.9);
      font-family: "Inter", system-ui, -apple-system, Segoe UI, sans-serif;
      display: none;
      flex-direction: column;
      gap: 10px;
      z-index: 10000;
      backdrop-filter: blur(6px);
    }

    .feedback-panel.show {
      display: flex;
    }

    .feedback-panel h3 {
      margin: 0;
      font-size: 14px;
      letter-spacing: 0.08em;
      text-transform: uppercase;
    }

    .feedback-panel label {
      display: grid;
      gap: 6px;
      font-size: 11px;
      letter-spacing: 0.06em;
      text-transform: uppercase;
    }

    .feedback-panel input,
    .feedback-panel textarea {
      width: 100%;
      background: rgba(15, 17, 23, 0.6);
      border: 1px solid rgba(148, 163, 184, 0.35);
      color: rgba(226, 232, 240, 0.9);
      border-radius: 10px;
      padding: 10px 12px;
      font-size: 13px;
      font-family: inherit;
    }

    .feedback-panel textarea {
      min-height: 100px;
      resize: vertical;
    }

    .feedback-panel .feedback-actions {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
    }

    .feedback-panel button {
      padding: 8px 12px;
      border-radius: 999px;
      border: 1px solid rgba(79, 124, 255, 0.35);
      background: rgba(79, 124, 255, 0.18);
      color: rgba(226, 232, 255, 0.9);
      letter-spacing: 0.08em;
      cursor: pointer;
    }

    .feedback-status {
      font-size: 11px;
      color: rgba(226, 232, 255, 0.6);
      min-height: 18px;
    }

    .voice-preview-placeholder {
      text-align: center;
      color: var(--muted);
      font-size: 14px;
      line-height: 1.5;
      padding: 24px;
    }

    body:not(.embed) .chat-modal {
      max-width: 920px;
      margin: 0 auto 96px;
    }

    body:not(.embed) .chat-modal::before {
      content: attr(data-demo-title);
      display: block;
      font-size: 24px;
      letter-spacing: -0.01em;
      color: var(--text);
      margin: 0 0 16px;
      font-weight: 600;
    }

    @media (max-width: 720px) {
      .hero {
        padding: 48px 18px;
      }

      .hero::after {
        inset: 8px;
      }

      .section-title {
        font-size: 24px;
      }

      .section-lead {
        font-size: 15px;
      }

      .embed-section,
      .voice-section {
        padding: 24px;
      }

      .copy-btn {
        position: static;
        justify-self: flex-end;
        margin-bottom: 12px;
      }

      .code-card {
        padding-top: 12px;
      }
    }

    body.embed .toolbar,
    body.embed .project-panel,
    body.embed #saveCfg,
    body.embed #themeToggle,
    body.embed #baseUrl,
    body.embed #refreshProjects,
    body.embed #projectDebugHint,
    body.embed #savePrompt,
    body.embed #promptStatus {
      display: none !important;
    }

    body.embed form {
      grid-template-columns: 1fr auto;
    }

    body.embed form>.btn.secondary {
      order: 3;
    }

    body.embed #messages {
      flex: 1 1 auto;
      height: auto;
    }

    body.embed .container {
      padding: 14px;
      flex: 1 1 auto;
    }

    body:not(.embed) .widget-launcher,
    body:not(.embed) .chat-backdrop {
      display: none !important;
    }

    body:not(.embed) .chat-modal {
      position: static;
      display: block;
      padding: 0;
    }

    body:not(.embed) .chat-window {
      width: 100%;
      max-height: none;
      background: none;
      border: none;
      box-shadow: none;
      border-radius: 0;
    }

    body:not(.embed) .chat-header {
      display: none;
    }

    body:not(.embed) .chat-body {
      flex: none;
    }

    @media (max-width: 720px) {
      .download-section {
        padding: 32px 20px;
      }

      .download-grid {
        grid-template-columns: 1fr;
      }
    }

    @media (max-width: 480px) {
      .widget-launcher {
        padding: 9px 14px;
      }

      .widget-launcher[data-position="bottom-right"],
      .widget-launcher.pos-bottom-right {
        right: 16px;
        bottom: 16px;
      }

      .widget-launcher[data-position="bottom-left"],
      .widget-launcher.pos-bottom-left {
        left: 16px;
        bottom: 16px;
      }

      .widget-launcher[data-position="top-right"],
      .widget-launcher.pos-top-right {
        right: 16px;
        top: 16px;
      }

      .widget-launcher[data-position="top-left"],
      .widget-launcher.pos-top-left {
        left: 16px;
        top: 16px;
      }

      .chat-modal {
        padding: 12px;
      }

      .chat-window {
        width: 100%;
        max-height: calc(100vh - 24px);
      }
    }
  </style>
</head>

<body>
  <div class="auth-modal" id="admin-auth-modal" data-visible="false" role="dialog" aria-modal="true">
    <div class="auth-backdrop"></div>
    <div class="auth-card">
      <h3 id="admin-auth-title" data-i18n="authTitle">Administrator sign-in</h3>
      <p id="admin-auth-message" data-i18n="authPrompt">Enter administrator credentials to continue.</p>
      <p id="admin-auth-hint">Credentials will be sent to localhost</p>
      <form class="auth-form" id="admin-auth-form">
        <label for="admin-auth-username">
          <span data-i18n="authUsernameLabel">Username</span>
          <input type="text" id="admin-auth-username" autocomplete="username"
            data-i18n-placeholder="authUsernamePlaceholder">
        </label>
        <label for="admin-auth-password">
          <span data-i18n="authPasswordLabel">Password</span>
          <input type="password" id="admin-auth-password" autocomplete="current-password"
            data-i18n-placeholder="authPasswordPlaceholder">
        </label>
        <div class="auth-error" id="admin-auth-error"></div>
        <div class="auth-actions">
          <button type="button" class="btn secondary" id="admin-auth-cancel" data-i18n="authCancel">Cancel</button>
          <button type="submit" class="btn" id="admin-auth-submit" data-i18n="authSubmit">Sign in</button>
        </div>
      </form>
    </div>
  </div>
  <div class="page-shell" id="pageShell">
    <section class="hero">
      <div class="hero-copy">
        <h1 class="hero-title" data-i18n="heroTitle">AI consultant for your website</h1>
        <p class="hero-lead" data-i18n="heroSubtitle">Embed a streaming assistant or a voice avatar anywhere in minutes.
        </p>
        <div class="hero-actions">
          <button type="button" class="hero-cta" id="heroDemoBtn" data-i18n="heroLaunchDemo">Open live demo</button>
          <a class="hero-link" href="#embedShowcase" data-i18n="heroSecondary">See embed options</a>
        </div>
      </div>
      <div class="hero-visual" aria-hidden="true">
        <div class="hero-orb"></div>
        <div class="hero-ring"></div>
        <div class="hero-badge">AI</div>
        <div class="hero-pulse"></div>
      </div>
    </section>

    <section class="embed-section" id="embedShowcase">
      <div class="section-header">
        <h2 class="section-title" data-i18n="embedSectionTitle">Chat widget embed options</h2>
        <p class="section-lead" data-i18n="embedSectionSubtitle">Choose the presentation style and copy a ready-to-paste
          snippet for your site.</p>
      </div>
      <div class="embed-tabs" role="tablist">
        <button type="button" class="embed-tab active" data-embed-tab="floating" data-i18n="embedTabFloating">Floating
          bubble</button>
        <button type="button" class="embed-tab" data-embed-tab="inline" data-i18n="embedTabInline">Inline card</button>
        <button type="button" class="embed-tab" data-embed-tab="iframe" data-i18n="embedTabIframe">Full frame</button>
      </div>
      <div class="embed-controls">
        <label>
          <span data-i18n="embedConfigBase">Base URL</span>
          <input type="text" id="embedBase" placeholder="https://your-domain.com" autocomplete="off"
            spellcheck="false" />
        </label>
        <label>
          <span data-i18n="embedConfigProject">Project slug</span>
          <input type="text" id="embedProject" placeholder="demo" autocomplete="off" />
        </label>
        <label>
          <span data-i18n="embedConfigAccent">Accent colour</span>
          <input type="color" id="embedAccent" value="#4f7cff" />
        </label>
        <label class="embed-reading">
          <input type="checkbox" id="embedReadingMode" />
          <span data-i18n="embedReadingLabel">Enable book reading mode</span>
        </label>
        <label>
          <span data-i18n="embedConfigTheme">Theme</span>
          <select id="embedTheme">
            <option value="" data-i18n="embedThemeAuto">Auto</option>
            <option value="dark" data-i18n="embedThemeDark">Dark</option>
            <option value="light" data-i18n="embedThemeLight">Light</option>
          </select>
        </label>
        <div class="embed-position-picker">
          <span class="embed-position-label" data-i18n="embedPositionLabel">Launcher position</span>
          <div class="embed-position-preview" id="embedPositionPreview" data-position="bottom-right">
            <button type="button" class="embed-position-zone" data-position-option="top-left"
              aria-label="Top left"></button>
            <button type="button" class="embed-position-zone" data-position-option="top-right"
              aria-label="Top right"></button>
            <button type="button" class="embed-position-zone" data-position-option="bottom-left"
              aria-label="Bottom left"></button>
            <button type="button" class="embed-position-zone" data-position-option="bottom-right"
              aria-label="Bottom right"></button>
            <div class="embed-position-marker" id="embedPositionMarker">AI</div>
          </div>
          <span class="embed-position-helper" data-i18n="embedPositionHint">Preview only â€” the floating mode applies on
            your site.</span>
          <input type="hidden" id="embedPosition" value="bottom-right" />
        </div>
      </div>
      <div class="code-card">
        <button type="button" class="copy-btn" id="embedCopy" data-i18n="embedCopy">Copy snippet</button>
        <pre><code id="embedCode"></code></pre>
      </div>
    </section>

    <section class="voice-section" id="voiceSection">
      <div class="section-header">
        <h2 class="section-title" data-i18n="avatarSectionTitle">Voice-enabled avatar</h2>
        <p class="section-lead" data-i18n="avatarSectionSubtitle">Let visitors speak with an animated assistant that
          streams and reads answers aloud.</p>
      </div>
      <div class="voice-layout">
        <div class="voice-preview" id="voiceAvatarHost">
          <div class="voice-preview-placeholder" data-i18n="avatarPreviewSelect">Select a project to preview the voice
            assistant.</div>
        </div>
        <div class="voice-controls">
          <div class="voice-mode-select">
            <span class="voice-mode-label" id="voiceModeLabel" data-i18n="avatarModeLabel">Interaction mode</span>
            <div class="voice-mode-options" role="radiogroup" aria-labelledby="voiceModeLabel">
              <label class="voice-mode-option" data-mode-option="text">
                <input type="radio" name="avatarMode" value="text">
                <span data-i18n="avatarModeText">Text chat</span>
              </label>
              <label class="voice-mode-option is-active" data-mode-option="voice">
                <input type="radio" name="avatarMode" value="voice" checked>
                <span data-i18n="avatarModeVoice">Voice chat</span>
              </label>
              <label class="voice-mode-option" data-mode-option="avatar">
                <input type="radio" name="avatarMode" value="avatar">
                <span data-i18n="avatarModeAvatar">Voice + avatar</span>
              </label>
            </div>
          </div>
          <div class="avatar-character-panel" id="characterPanel" hidden>
            <span class="voice-mode-label" data-i18n="avatarCharacterLabel">Choose an avatar</span>
            <div class="avatar-character-grid">
              <button type="button" class="avatar-character-card is-active" data-avatar-option="luna">
                <span class="avatar-character-name" data-i18n="avatarCharacterLunaName">Luna</span>
                <span class="avatar-character-desc" data-i18n="avatarCharacterLunaDesc">Warm customer success
                  partner</span>
              </button>
              <button type="button" class="avatar-character-card" data-avatar-option="amir">
                <span class="avatar-character-name" data-i18n="avatarCharacterAmirName">Amir</span>
                <span class="avatar-character-desc" data-i18n="avatarCharacterAmirDesc">Thoughtful technical
                  guide</span>
              </button>
              <button type="button" class="avatar-character-card" data-avatar-option="sofia">
                <span class="avatar-character-name" data-i18n="avatarCharacterSofiaName">Sofia</span>
                <span class="avatar-character-desc" data-i18n="avatarCharacterSofiaDesc">Confident sales lead</span>
              </button>
              <button type="button" class="avatar-character-card" data-avatar-option="nova">
                <span class="avatar-character-name" data-i18n="avatarCharacterNovaName">Nova</span>
                <span class="avatar-character-desc" data-i18n="avatarCharacterNovaDesc">Empathic product
                  specialist</span>
              </button>
              <button type="button" class="avatar-character-card" data-avatar-option="atlas">
                <span class="avatar-character-name" data-i18n="avatarCharacterAtlasName">Atlas</span>
                <span class="avatar-character-desc" data-i18n="avatarCharacterAtlasDesc">Calm operations engineer</span>
              </button>
              <button type="button" class="avatar-character-card" data-avatar-option="cosmo">
                <span class="avatar-character-name" data-i18n="avatarCharacterCosmoName">Cosmo</span>
                <span class="avatar-character-desc" data-i18n="avatarCharacterCosmoDesc">Futuristic guide</span>
              </button>
              <button type="button" class="avatar-character-card" data-avatar-option="ivan">
                <span class="avatar-character-name" data-i18n="avatarCharacterIvanName">Ivan Ivanych</span>
                <span class="avatar-character-desc" data-i18n="avatarCharacterIvanDesc">Seasoned 3D mentor for confident
                  launches</span>
              </button>
            </div>
          </div>
          <div class="voice-grid">
            <label>
              <span data-i18n="avatarLangLabel">Recognition language</span>
              <input type="text" id="avatarLang" value="ru-RU" autocomplete="off" />
            </label>
            <label class="voice-choice">
              <span data-i18n="avatarVoiceLabel">Speech voice (optional)</span>
              <input type="text" id="avatarVoice" placeholder="Milena" autocomplete="off" list="avatarVoiceList" />
              <datalist id="avatarVoiceList"></datalist>
            </label>
          </div>
          <div class="voice-tuning">
            <label class="voice-speed">
              <span data-i18n="avatarSpeechRateLabel">Speech speed</span>
              <input type="range" id="speechRate" min="0.6" max="1.4" step="0.05" value="1.0">
              <output id="speechRateDisplay">Ã—1.00</output>
            </label>
            <div class="voice-test">
              <textarea id="voiceTestText" data-i18n-placeholder="avatarTestPlaceholder"
                placeholder="Enter a short line to preview the voiceâ€¦"></textarea>
              <button type="button" id="voiceTestBtn" data-i18n="avatarTestButton">Play sample</button>
            </div>
          </div>
          <div class="code-card">
            <button type="button" class="copy-btn" id="avatarCopy" data-i18n="avatarCopy">Copy widget snippet</button>
            <pre><code id="avatarCode"></code></pre>
          </div>
          <p class="muted" id="voiceFeatureHint" data-i18n="avatarHintSelectProject">Select a project to preview the
            voice assistant.</p>
        </div>
      </div>
    </section>

    <section class="download-section" id="desktopDownloads">
      <h2>Desktop assistant for Windows &amp; Linux</h2>
      <p>
        Launch the voice avatar as a standalone program that stays on top of other windows, supports the same animated
        characters, and listens for a wake word. Build installers from <code>widget/desktop</code> or place your signed
        binaries in the paths below and the links will serve them directly.
      </p>
      <div class="download-grid">
        <article class="download-card">
          <h3>Windows (x64)</h3>
          <p>Includes hotword activation, animated avatar, and auto-start options.</p>
          <button type="button" class="btn" data-build-platform="windows">
            Build &amp; download .exe
          </button>
        </article>
        <article class="download-card">
          <h3>Linux (AppImage / deb)</h3>
          <p>Runs on any modern distribution, stays always-on-top, supports microphone wake word.</p>
          <div class="download-links">
            <button type="button" class="btn" data-build-platform="linux-appimage">
              Build AppImage
            </button>
            <button type="button" class="btn secondary" data-build-platform="linux-deb">
              Build deb package
            </button>
          </div>
        </article>
      </div>
      <div class="download-note">
        Builds run on demand when you click a button. Ensure <code>npm</code> and <code>electron-builder</code> are
        available on the server.
        <div class="download-status" id="desktopBuildStatus" role="status" aria-live="polite">
          Click a button to build the latest installer for your platform.
        </div>
      </div>
    </section>
  </div>
  <div class="widget-launcher pos-bottom-right" id="widgetLauncher" aria-label="Open chat"
    data-i18n-aria-label="launcherAria" data-position="bottom-right">
    <div class="launcher-avatar">AI</div>
    <div class="launcher-text">
      <strong data-i18n="launcherTitle">AI Assistant</strong>
      <span data-i18n="launcherSubtitle">Ask me anything</span>
    </div>
  </div>
  <div class="chat-backdrop" id="chatBackdrop"></div>
  <div class="chat-modal" id="chatModal" data-demo-title="Live chat preview">
    <div class="chat-window">
      <div class="chat-header">
        <div>
          <div class="chat-title" data-i18n="chatTitle">AI Assistant</div>
          <div class="chat-subtitle" data-i18n="chatSubtitle">Ready to help with your questions</div>
        </div>
        <button class="chat-close" id="chatClose" aria-label="Close" data-i18n-aria-label="chatClose">Ã—</button>
      </div>
      <div class="chat-body">
        <div class="container">
          <div class="toolbar">
            <strong data-i18n="toolbarTitle">LLM Chat Widget</strong>
            <span class="spacer"></span>
            <input type="text" id="baseUrl" placeholder="API base (optional), e.g. http://host:18000"
              data-i18n-placeholder="basePlaceholder" />
            <button id="saveCfg" class="btn secondary" data-i18n="saveButton">Save</button>
            <button id="themeToggle" class="btn secondary" title="Toggle theme" data-i18n="themeButton">Theme</button>
            <select id="languageSelect" aria-label="Language" data-i18n-aria-label="languageLabel"></select>
            <span id="health" class="status"><span class="dot" id="healthDot"></span><span id="healthText"
                data-status-key="unknown">unknown</span></span>
          </div>

          <div id="banner"
            style="display:none; border:1px solid var(--error); color:#fff; background:#3a1f1f; padding:8px 10px; border-radius:6px; margin:10px 0;"
            data-active="false">
            <span id="bannerText" data-i18n="bannerConnectionError">Connection error</span>
            <button id="bannerClose" class="btn secondary" style="float:right;"
              data-i18n="bannerDismiss">Dismiss</button>
          </div>

          <div class="project-panel">
            <div>
              <label for="projectSelect" data-i18n="projectLabel">Project</label>
              <div class="row">
                <select id="projectSelect" class="grow"></select>
                <button id="refreshProjects" class="btn secondary" type="button"
                  data-i18n="reloadProjects">Reload</button>
              </div>
              <div class="muted" id="projectInfo">No project selected</div>
            </div>
            <div class="row" style="align-items:center;">
              <label class="checkbox">
                <input type="checkbox" id="projectDebug">
                <span data-i18n="debugLabel">Debug</span>
              </label>
              <span class="muted" id="projectDebugHint">Show extended events in chat</span>
            </div>
            <div>
              <label for="startPrompt" data-i18n="startPromptLabel">Initial prompt</label>
              <textarea id="startPrompt" placeholder="Project initial prompt"
                data-i18n-placeholder="startPromptPlaceholder"></textarea>
              <div class="actions">
                <button id="savePrompt" class="btn secondary" type="button" data-i18n="savePrompt">Save prompt</button>
                <span id="promptStatus" class="muted"></span>
              </div>
            </div>
          </div>

          <div id="messages"></div>
          <form id="chat-form">
            <textarea id="question" placeholder="Ask a question (Shift+Enter = newline)" autocomplete="off"
              data-i18n-placeholder="questionPlaceholder"></textarea>
            <button type="button" id="stop" class="btn secondary" disabled data-i18n="stopButton">Stop</button>
            <button type="submit" id="sendBtn" class="btn" data-i18n="sendButton">Send</button>
            <div class="muted" id="inputHint"><span id="hintSend">Enter to send</span><span>&nbsp;â€¢&nbsp;</span><span
                id="hintNewline">Shift+Enter for newline</span><span>&nbsp;â€¢&nbsp;</span><a href="#"
                id="clear">Clear</a></div>
          </form>
        </div>
      </div>
    </div>
    <a href="https://dev-bot.su" class="developer-credit" target="_blank" rel="noopener"
      data-i18n="developerCredit">Created by Ð´ÐµÐ²-Ð±Ð¾Ñ‚-ÑÑƒ</a>
    <button type="button" class="feedback-trigger" id="feedbackTrigger" data-i18n="feedbackButton">Feedback</button>
    <div class="feedback-panel" id="feedbackPanel">
      <div class="feedback-actions">
        <h3 data-i18n="feedbackTitle">Help us improve</h3>
        <button type="button" id="feedbackClose" data-i18n="feedbackClose">Close</button>
      </div>
      <p class="muted" data-i18n="feedbackDivider">We appreciate your input!</p>
      <form id="feedbackForm">
        <label>
          <span data-i18n="feedbackName">Your name (optional)</span>
          <input type="text" id="feedbackName" autocomplete="off" />
        </label>
        <label>
          <span data-i18n="feedbackContact">Contact info (optional)</span>
          <input type="text" id="feedbackContact" autocomplete="off" />
        </label>
        <label>
          <span data-i18n="feedbackMessage">Describe your suggestion or issue</span>
          <textarea id="feedbackMessage" placeholder="Share your idea or problemâ€¦"
            data-i18n-placeholder="feedbackPlaceholder"></textarea>
        </label>
        <div class="feedback-actions">
          <button type="submit" id="feedbackSubmit" data-i18n="feedbackSend">Send feedback</button>
          <span class="feedback-status" id="feedbackStatus"></span>
        </div>
      </form>
    </div>
  </div>
  <script>
    const form = document.getElementById('chat-form');
    const input = document.getElementById('question');
    const messages = document.getElementById('messages');
    const stopBtn = document.getElementById('stop');
    const clearLink = document.getElementById('clear');
    const baseUrlInput = document.getElementById('baseUrl');
    const saveCfgBtn = document.getElementById('saveCfg');
    const healthDot = document.getElementById('healthDot');
    const healthText = document.getElementById('healthText');
    const sendBtn = document.getElementById('sendBtn');
    const banner = document.getElementById('banner');
    const bannerText = document.getElementById('bannerText');
    const bannerClose = document.getElementById('bannerClose');
    const authModal = document.getElementById('admin-auth-modal');
    const authForm = document.getElementById('admin-auth-form');
    const authUserInput = document.getElementById('admin-auth-username');
    const authPasswordInput = document.getElementById('admin-auth-password');
    const authSubmitBtn = document.getElementById('admin-auth-submit');
    const authCancelBtn = document.getElementById('admin-auth-cancel');
    const authError = document.getElementById('admin-auth-error');
    const authHint = document.getElementById('admin-auth-hint');
    const authMessage = document.getElementById('admin-auth-message');
    const themeToggle = document.getElementById('themeToggle');
    const projectSelect = document.getElementById('projectSelect');
    const refreshProjectsBtn = document.getElementById('refreshProjects');
    const projectInfo = document.getElementById('projectInfo');
    const startPromptInput = document.getElementById('startPrompt');
    const savePromptBtn = document.getElementById('savePrompt');
    const desktopBuildButtons = document.querySelectorAll('[data-build-platform]');
    const desktopBuildStatus = document.getElementById('desktopBuildStatus');
    const DESKTOP_FILENAME_FALLBACKS = {
      windows: 'SiteLLMAssistant-Setup.exe',
      'linux-appimage': 'SiteLLMAssistant.AppImage',
      'linux-deb': 'sitellm-assistant.deb',
    };
    const DESKTOP_PLATFORM_LABELS = {
      windows: 'Windows installer',
      'linux-appimage': 'Linux AppImage',
      'linux-deb': 'Linux deb package',
    };
    const promptStatus = document.getElementById('promptStatus');
    const debugCheckbox = document.getElementById('projectDebug');
    const debugHint = document.getElementById('projectDebugHint');
    const languageSelect = document.getElementById('languageSelect');
    const hintSend = document.getElementById('hintSend');
    const hintNewline = document.getElementById('hintNewline');
    const inputHint = document.getElementById('inputHint');
    const widgetLauncher = document.getElementById('widgetLauncher');
    const chatModal = document.getElementById('chatModal');
    const chatBackdrop = document.getElementById('chatBackdrop');
    const chatClose = document.getElementById('chatClose');
    const heroDemoBtn = document.getElementById('heroDemoBtn');
    const embedTabs = Array.from(document.querySelectorAll('[data-embed-tab]'));
    const embedCodeEl = document.getElementById('embedCode');
    const embedCopyBtn = document.getElementById('embedCopy');
    const embedBaseInput = document.getElementById('embedBase');
    const embedProjectInput = document.getElementById('embedProject');
    const embedAccentInput = document.getElementById('embedAccent');
    const embedThemeSelect = document.getElementById('embedTheme');
    const embedReadingInput = document.getElementById('embedReadingMode');
    const embedPositionInput = document.getElementById('embedPosition');
    const embedPositionButtons = Array.from(document.querySelectorAll('[data-position-option]'));
    const embedPositionPreview = document.getElementById('embedPositionPreview');
    const embedPositionMarker = document.getElementById('embedPositionMarker');
    const voiceAvatarHost = document.getElementById('voiceAvatarHost');
    const avatarLangInput = document.getElementById('avatarLang');
    const avatarVoiceInput = document.getElementById('avatarVoice');
    const avatarVoiceList = document.getElementById('avatarVoiceList');
    const avatarModeOptions = Array.from(document.querySelectorAll('[data-mode-option]'));
    const avatarModeInputs = Array.from(document.querySelectorAll('input[name="avatarMode"]'));
    const avatarCharacterPanel = document.getElementById('characterPanel');
    const avatarCharacterCards = Array.from(document.querySelectorAll('[data-avatar-option]'));
    const voiceGridEl = document.querySelector('.voice-grid');
    const speechRateInput = document.getElementById('speechRate');
    const speechRateDisplay = document.getElementById('speechRateDisplay');
    const voiceTestTextarea = document.getElementById('voiceTestText');
    const voiceTestBtn = document.getElementById('voiceTestBtn');
    const avatarCodeEl = document.getElementById('avatarCode');
    const avatarCopyBtn = document.getElementById('avatarCopy');
    const voiceFeatureHint = document.getElementById('voiceFeatureHint');
    const feedbackTrigger = document.getElementById('feedbackTrigger');
    const feedbackPanel = document.getElementById('feedbackPanel');
    const feedbackForm = document.getElementById('feedbackForm');
    const feedbackCloseBtn = document.getElementById('feedbackClose');
    const feedbackStatus = document.getElementById('feedbackStatus');
    const feedbackNameInput = document.getElementById('feedbackName');
    const feedbackContactInput = document.getElementById('feedbackContact');
    const feedbackMessageInput = document.getElementById('feedbackMessage');
    const feedbackSubmitBtn = document.getElementById('feedbackSubmit');

    desktopBuildButtons.forEach((button) => {
      button.addEventListener('click', () => {
        const platformKey = button.dataset.buildPlatform;
        handleDesktopBuild(button, platformKey);
      });
    });

    const urlParams = new URLSearchParams(window.location.search);
    const urlProject = (urlParams.get('project') || '').trim().toLowerCase();
    let currentProject = urlProject || (localStorage.getItem('chat_project') || '').trim().toLowerCase();
    const isEmbed = window.self !== window.top || urlParams.get('embed') === '1';
    let activeEmbedVariant = 'floating';
    let voiceRenderTimer = null;
    const voiceConfigCache = new Map();
    const voiceHintState = { status: 'select', model: null };
    let remoteVoiceState = { key: '', enabled: true, model: null };
    let voicePreviewToken = 0;
    let voicePlaceholderState = { key: 'avatarPreviewSelect', params: null };
    let selectedVoiceMode = 'voice';
    let selectedAvatarCharacter = 'luna';

    const LANGUAGE_STORAGE_KEY = 'chat_language';
    const VOICE_STORAGE_KEY = 'chat_voice_preference';
    const SPEECH_RATE_STORAGE_KEY = 'chat_voice_speed';
    const DEFAULT_VOICE_HINT = 'Milena';
    let voiceOptionsPending = false;
    const FALLBACK_LANGUAGE = 'en';
    const pageReadingMode = urlParams.get('reading') === '1';
    let widgetReadingMode = pageReadingMode;
    let currentVoicePreviewInstance = null;
    const FLOATING_POSITIONS = ['bottom-right', 'bottom-left', 'top-right', 'top-left'];

    if (isEmbed) {
      document.querySelectorAll('.feedback-trigger, .feedback-panel, .developer-credit').forEach((node) => {
        if (node) node.style.display = 'none';
      });
    }
    const LANGUAGES = {
      en: {
        name: 'English',
        dir: 'ltr',
        strings: {
          heroTitle: 'AI consultant for your website',
          heroSubtitle: 'Embed a streaming assistant or a voice avatar anywhere in minutes.',
          heroLaunchDemo: 'Open live demo',
          heroSecondary: 'See embed options',
          embedSectionTitle: 'Chat widget embed options',
          embedSectionSubtitle: 'Choose the presentation style and copy a ready-to-paste snippet for your site.',
          embedTabFloating: 'Floating bubble',
          embedTabInline: 'Inline card',
          embedTabIframe: 'Full frame',
          embedConfigBase: 'Base URL',
          embedConfigProject: 'Project slug',
          embedConfigAccent: 'Accent colour',
          embedConfigTheme: 'Theme',
          embedPositionLabel: 'Launcher position',
          embedPositionBottomRight: 'Bottom right',
          embedPositionBottomLeft: 'Bottom left',
          embedPositionTopRight: 'Top right',
          embedPositionTopLeft: 'Top left',
          embedPositionHint: 'Preview only â€” the widget floats on your site.',
          embedReadingLabel: 'Enable book reading mode',
          embedThemeAuto: 'Auto',
          embedThemeDark: 'Dark',
          embedThemeLight: 'Light',
          embedCopy: 'Copy snippet',
          avatarSectionTitle: 'Voice-enabled avatar',
          avatarSectionSubtitle: 'Let visitors speak with an animated assistant that streams and reads answers aloud.',
          avatarLangLabel: 'Recognition language',
          avatarModeLabel: 'Interaction mode',
          avatarModeText: 'Text chat',
          avatarModeVoice: 'Voice chat',
          avatarModeAvatar: 'Voice + avatar',
          avatarCharacterLabel: 'Choose an avatar',
          avatarCharacterLunaName: 'Luna',
          avatarCharacterLunaDesc: 'Warm customer success partner',
          avatarCharacterAmirName: 'Amir',
          avatarCharacterAmirDesc: 'Thoughtful technical guide',
          avatarCharacterSofiaName: 'Sofia',
          avatarCharacterSofiaDesc: 'Confident sales lead',
          avatarCharacterNovaName: 'Nova',
          avatarCharacterNovaDesc: 'Empathic product specialist',
          avatarCharacterAtlasName: 'Atlas',
          avatarCharacterAtlasDesc: 'Calm operations engineer',
          avatarCharacterCosmoName: 'Cosmo',
          avatarCharacterCosmoDesc: 'Futuristic guide',
          avatarCharacterIvanName: 'Ivan Ivanych',
          avatarCharacterIvanDesc: 'Seasoned 3D mentor for confident launches',
          avatarVoiceLabel: 'Speech voice (optional)',
          avatarSpeechRateLabel: 'Speech speed',
          avatarTestPlaceholder: 'Enter a short line to preview the voiceâ€¦',
          avatarTestButton: 'Play sample',
          avatarCopy: 'Copy widget snippet',
          avatarPreviewSelect: 'Select a project to preview the voice assistant.',
          avatarHintSelectProject: 'Select a project to preview the voice assistant.',
          avatarHintLoading: 'Loading voice settingsâ€¦',
          avatarHintDisabled: 'Voice assistant is disabled for this project.',
          avatarHintEnabled: 'Voice assistant is enabled for this project.',
          avatarHintEnabledModel: 'Voice assistant uses model {model}.',
          avatarHintError: 'Unable to load voice settings.',
          avatarHintTextMode: 'Text-only chat mode is active. Visitors will type instead of speaking.',
          avatarHintAvatarMode: 'Avatar mode enabled. Animated persona mirrors the assistant during replies.',
          avatarHintAvatarAppend: 'Animated persona will accompany spoken responses.',
          avatarHintReadingMode: 'Book reading mode is active.',
          copiedLabel: 'Copied!',
          chatPreviewTitle: 'Live chat preview',
          launcherTitle: 'AI Assistant',
          launcherSubtitle: 'Ask me anything',
          launcherAria: 'Open chat',
          chatTitle: 'AI Assistant',
          chatSubtitle: 'Ready to help with your questions',
          chatClose: 'Close',
          toolbarTitle: 'LLM Chat Widget',
          basePlaceholder: 'API base (optional), e.g. http://host:18000',
          saveButton: 'Save',
          themeButton: 'Theme',
          languageLabel: 'Language',
          statusUnknown: 'unknown',
          statusOk: 'online',
          statusOffline: 'offline',
          bannerConnectionError: 'Connection error',
          bannerDismiss: 'Dismiss',
          authTitle: 'Administrator sign-in',
          authPrompt: 'Enter administrator credentials to continue.',
          authHint: 'Credentials are sent to {host}.',
          authUsernameLabel: 'Username',
          authUsernamePlaceholder: 'Admin username',
          authPasswordLabel: 'Password',
          authPasswordPlaceholder: 'Admin password',
          authSubmit: 'Sign in',
          authCancel: 'Cancel',
          authStatusChecking: 'Checking credentialsâ€¦',
          authErrorMissing: 'Enter username and password',
          authErrorInvalid: 'Invalid credentials',
          authErrorNetwork: 'Could not verify credentials',
          errorAuthRequired: 'Administrator credentials required',
          feedbackButton: 'Feedback',
          feedbackOpen: 'Open feedback form',
          feedbackClose: 'Close',
          feedbackTitle: 'Help us improve',
          feedbackName: 'Your name (optional)',
          feedbackContact: 'Contact info (optional)',
          feedbackMessage: 'Describe your suggestion or issue',
          feedbackPlaceholder: 'Share your idea or problemâ€¦',
          feedbackSend: 'Send feedback',
          feedbackSending: 'Sendingâ€¦',
          feedbackSuccess: 'Thanks! We received your message.',
          feedbackThanks: 'We will read your feedback soon.',
          feedbackError: 'Could not send feedback. Please try later.',
          feedbackDivider: 'We appreciate your input!',
          developerCredit: 'Created by Ð´ÐµÐ²-Ð±Ð¾Ñ‚-ÑÑƒ',
          feedbackSectionTitle: 'Feedback',
          feedbackStatusOpen: 'Open',
          feedbackStatusInProgress: 'In progress',
          feedbackStatusDone: 'Resolved',
          feedbackStatusDismissed: 'Dismissed',
          feedbackNoItems: 'No feedback yet.',
          feedbackUpdated: 'Updated',
          projectLabel: 'Project',
          reloadProjects: 'Reload',
          projectInfoNone: 'No project selected',
          projectInfoSelected: 'Current project: {project}',
          debugLabel: 'Debug',
          debugHintOff: 'Show extended events in chat',
          debugHintOn: 'Extended events enabled',
          startPromptLabel: 'Initial prompt',
          startPromptPlaceholder: 'Project initial prompt',
          savePrompt: 'Save prompt',
          questionPlaceholder: 'Ask a question (Shift+Enter = newline)',
          stopButton: 'Stop',
          sendButton: 'Send',
          inputHintSend: 'Enter to send',
          inputHintNewline: 'Shift+Enter for newline',
          clearLink: 'Clear',
          errorLoadProjects: 'Failed to load projects',
          statusSaving: 'Savingâ€¦',
          statusSaved: 'Saved',
          statusError: 'Error',
          errorStreaming: 'Streaming error, see console.',
          errorNoSSE: 'SSE not supported by this browser.',
          attachmentLabel: 'Attachment',
          sourcesTitle: 'Sources',
          roleUser: 'user',
          roleAssistant: 'assistant',
          roleSystem: 'system',
          roleDebug: 'debug'
        }
      },
      es: {
        name: 'EspaÃ±ol',
        dir: 'ltr',
        strings: {
          heroTitle: 'Consultor IA para tu sitio web',
          heroSubtitle: 'Integra un asistente en streaming o un avatar con voz en cuestiÃ³n de minutos.',
          heroLaunchDemo: 'Abrir demo en vivo',
          heroSecondary: 'Ver opciones de inserciÃ³n',
          embedSectionTitle: 'Opciones de inserciÃ³n del widget',
          embedSectionSubtitle: 'Elige la presentaciÃ³n y copia un fragmento listo para pegar en tu sitio.',
          embedTabFloating: 'Burbuja flotante',
          embedTabInline: 'Tarjeta incrustada',
          embedTabIframe: 'Marco completo',
          embedConfigBase: 'URL base',
          embedConfigProject: 'Slug del proyecto',
          embedConfigAccent: 'Color de acento',
          embedConfigTheme: 'Tema',
          embedThemeAuto: 'AutomÃ¡tico',
          embedThemeDark: 'Oscuro',
          embedThemeLight: 'Claro',
          embedCopy: 'Copiar snippet',
          avatarSectionTitle: 'Avatar con voz',
          avatarSectionSubtitle: 'Permite que los visitantes hablen con un asistente animado que responde en voz alta.',
          avatarLangLabel: 'Idioma de reconocimiento',
          avatarVoiceLabel: 'Voz de sÃ­ntesis (opcional)',
          avatarCopy: 'Copiar widget',
          avatarPreviewSelect: 'Selecciona un proyecto para mostrar el asistente de voz.',
          avatarHintSelectProject: 'Selecciona un proyecto para mostrar el asistente de voz.',
          avatarHintLoading: 'Cargando configuraciÃ³n de vozâ€¦',
          avatarHintDisabled: 'El asistente de voz estÃ¡ desactivado para este proyecto.',
          avatarHintEnabled: 'El asistente de voz estÃ¡ activado para este proyecto.',
          avatarHintEnabledModel: 'El asistente de voz usa el modelo {model}.',
          avatarHintError: 'No se pudieron cargar los ajustes de voz.',
          copiedLabel: 'Â¡Copiado!',
          chatPreviewTitle: 'Vista previa del chat en vivo',
          launcherTitle: 'Asistente de IA',
          launcherSubtitle: 'Pregunta lo que quieras',
          launcherAria: 'Abrir chat',
          chatTitle: 'Asistente de IA',
          chatSubtitle: 'Listo para ayudarte con tus preguntas',
          chatClose: 'Cerrar',
          toolbarTitle: 'Widget de chat LLM',
          basePlaceholder: 'Base de API (opcional), p. ej. http://host:18000',
          saveButton: 'Guardar',
          themeButton: 'Tema',
          languageLabel: 'Idioma',
          statusUnknown: 'desconocido',
          statusOk: 'en lÃ­nea',
          statusOffline: 'sin conexiÃ³n',
          bannerConnectionError: 'Error de conexiÃ³n',
          bannerDismiss: 'Cerrar',
          projectLabel: 'Proyecto',
          reloadProjects: 'Actualizar',
          projectInfoNone: 'NingÃºn proyecto seleccionado',
          projectInfoSelected: 'Proyecto actual: {project}',
          debugLabel: 'DepuraciÃ³n',
          debugHintOff: 'Mostrar eventos ampliados en el chat',
          debugHintOn: 'Eventos ampliados activados',
          startPromptLabel: 'Mensaje inicial',
          startPromptPlaceholder: 'Mensaje inicial del proyecto',
          savePrompt: 'Guardar mensaje',
          questionPlaceholder: 'Haz una pregunta (MayÃºs+Enter = nueva lÃ­nea)',
          stopButton: 'Detener',
          sendButton: 'Enviar',
          inputHintSend: 'Enter para enviar',
          inputHintNewline: 'MayÃºs+Enter para nueva lÃ­nea',
          clearLink: 'Limpiar',
          errorLoadProjects: 'No se pudieron cargar los proyectos',
          statusSaving: 'Guardandoâ€¦',
          statusSaved: 'Guardado',
          statusError: 'Error',
          errorStreaming: 'Error de streaming, revisa la consola.',
          errorNoSSE: 'Este navegador no admite SSE.',
          attachmentLabel: 'Adjunto',
          sourcesTitle: 'Fuentes',
          roleUser: 'usuario',
          roleAssistant: 'asistente',
          roleSystem: 'sistema',
          roleDebug: 'depuraciÃ³n'
        }
      },
      de: {
        name: 'Deutsch',
        dir: 'ltr',
        strings: {
          heroTitle: 'KI-Berater fÃ¼r Ihre Website',
          heroSubtitle: 'Binden Sie in Minuten einen Streaming-Assistenten oder einen Sprachavatar ein.',
          heroLaunchDemo: 'Live-Demo Ã¶ffnen',
          heroSecondary: 'Einbindungsoptionen ansehen',
          embedSectionTitle: 'Einbindungsoptionen fÃ¼r das Chat-Widget',
          embedSectionSubtitle: 'WÃ¤hlen Sie das Layout und kopieren Sie den fertigen Code fÃ¼r Ihre Seite.',
          embedTabFloating: 'Schwebende Blase',
          embedTabInline: 'Eingebettete Karte',
          embedTabIframe: 'VollstÃ¤ndiger Frame',
          embedConfigBase: 'Basis-URL',
          embedConfigProject: 'Projekt-Slug',
          embedConfigAccent: 'Akzentfarbe',
          embedConfigTheme: 'Theme',
          embedThemeAuto: 'Automatisch',
          embedThemeDark: 'Dunkel',
          embedThemeLight: 'Hell',
          embedCopy: 'Snippet kopieren',
          avatarSectionTitle: 'Avatar mit Sprachsteuerung',
          avatarSectionSubtitle: 'Lassen Sie Besucher mit einem animierten Assistenten sprechen, der Antworten laut vorliest.',
          avatarLangLabel: 'Erkennungssprache',
          avatarVoiceLabel: 'Sprachstimme (optional)',
          avatarCopy: 'Widget kopieren',
          avatarPreviewSelect: 'WÃ¤hle ein Projekt, um den Sprachassistenten anzuzeigen.',
          avatarHintSelectProject: 'WÃ¤hle ein Projekt, um den Sprachassistenten anzuzeigen.',
          avatarHintLoading: 'Sprachkonfiguration wird geladenâ€¦',
          avatarHintDisabled: 'Der Sprachassistent ist fÃ¼r dieses Projekt deaktiviert.',
          avatarHintEnabled: 'Der Sprachassistent ist fÃ¼r dieses Projekt aktiviert.',
          avatarHintEnabledModel: 'Der Sprachassistent verwendet das Modell {model}.',
          avatarHintError: 'Sprachkonfiguration konnte nicht geladen werden.',
          copiedLabel: 'Kopiert!',
          chatPreviewTitle: 'Live-Chat-Vorschau',
          launcherTitle: 'KI-Assistent',
          launcherSubtitle: 'Frag mich alles',
          launcherAria: 'Chat Ã¶ffnen',
          chatTitle: 'KI-Assistent',
          chatSubtitle: 'Bereit, deine Fragen zu beantworten',
          chatClose: 'SchlieÃŸen',
          toolbarTitle: 'LLM-Chat-Widget',
          basePlaceholder: 'API-Basis (optional), z. B. http://host:18000',
          saveButton: 'Speichern',
          themeButton: 'Thema',
          languageLabel: 'Sprache',
          statusUnknown: 'unbekannt',
          statusOk: 'online',
          statusOffline: 'offline',
          bannerConnectionError: 'Verbindungsfehler',
          bannerDismiss: 'SchlieÃŸen',
          projectLabel: 'Projekt',
          reloadProjects: 'Aktualisieren',
          projectInfoNone: 'Kein Projekt ausgewÃ¤hlt',
          projectInfoSelected: 'Aktuelles Projekt: {project}',
          debugLabel: 'Debug',
          debugHintOff: 'Erweiterte Ereignisse im Chat anzeigen',
          debugHintOn: 'Erweiterte Ereignisse aktiviert',
          startPromptLabel: 'Start-Prompt',
          startPromptPlaceholder: 'Start-Prompt des Projekts',
          savePrompt: 'Prompt speichern',
          questionPlaceholder: 'Stelle eine Frage (Shift+Enter = neue Zeile)',
          stopButton: 'Stopp',
          sendButton: 'Senden',
          inputHintSend: 'Enter zum Senden',
          inputHintNewline: 'Shift+Enter fÃ¼r neue Zeile',
          clearLink: 'LÃ¶schen',
          errorLoadProjects: 'Projekte konnten nicht geladen werden',
          statusSaving: 'Wird gespeichertâ€¦',
          statusSaved: 'Gespeichert',
          statusError: 'Fehler',
          errorStreaming: 'Streaming-Fehler, siehe Konsole.',
          errorNoSSE: 'Dieser Browser unterstÃ¼tzt kein SSE.',
          attachmentLabel: 'Anhang',
          sourcesTitle: 'Quellen',
          roleUser: 'benutzer',
          roleAssistant: 'assistent',
          roleSystem: 'system',
          roleDebug: 'debug'
        }
      },
      fr: {
        name: 'FranÃ§ais',
        dir: 'ltr',
        strings: {
          heroTitle: 'Consultant IA pour votre site web',
          heroSubtitle: 'IntÃ©grez en quelques minutes un assistant en streaming ou un avatar vocal.',
          heroLaunchDemo: 'Ouvrir la dÃ©mo en direct',
          heroSecondary: 'Voir les options d\'intÃ©gration',
          embedSectionTitle: 'Options d\'intÃ©gration du widget de chat',
          embedSectionSubtitle: 'Choisissez la prÃ©sentation et copiez un extrait prÃªt Ã  coller sur votre site.',
          embedTabFloating: 'Bulle flottante',
          embedTabInline: 'Carte intÃ©grÃ©e',
          embedTabIframe: 'Cadre complet',
          embedConfigBase: 'URL de base',
          embedConfigProject: 'Identifiant projet',
          embedConfigAccent: 'Couleur d\'accent',
          embedConfigTheme: 'ThÃ¨me',
          embedThemeAuto: 'Auto',
          embedThemeDark: 'Sombre',
          embedThemeLight: 'Clair',
          embedCopy: 'Copier le snippet',
          avatarSectionTitle: 'Avatar avec voix',
          avatarSectionSubtitle: 'Permettez aux visiteurs de parler avec un assistant animÃ© qui lit les rÃ©ponses.',
          avatarLangLabel: 'Langue de reconnaissance',
          avatarVoiceLabel: 'Voix de synthÃ¨se (optionnel)',
          avatarCopy: 'Copier le widget',
          avatarPreviewSelect: 'SÃ©lectionnez un projet pour prÃ©visualiser lâ€™assistant vocal.',
          avatarHintSelectProject: 'SÃ©lectionnez un projet pour prÃ©visualiser lâ€™assistant vocal.',
          avatarHintLoading: 'Chargement des paramÃ¨tres vocauxâ€¦',
          avatarHintDisabled: 'Lâ€™assistant vocal est dÃ©sactivÃ© pour ce projet.',
          avatarHintEnabled: 'Lâ€™assistant vocal est activÃ© pour ce projet.',
          avatarHintEnabledModel: 'Lâ€™assistant vocal utilise le modÃ¨le {model}.',
          avatarHintError: 'Impossible de charger les paramÃ¨tres vocaux.',
          copiedLabel: 'CopiÃ© !',
          chatPreviewTitle: 'AperÃ§u du chat en direct',
          launcherTitle: 'Assistant IA',
          launcherSubtitle: 'Posez-moi vos questions',
          launcherAria: 'Ouvrir le chat',
          chatTitle: 'Assistant IA',
          chatSubtitle: 'PrÃªt Ã  rÃ©pondre Ã  vos questions',
          chatClose: 'Fermer',
          toolbarTitle: 'Widget de chat LLM',
          basePlaceholder: 'Base API (facultatif), ex. http://host:18000',
          saveButton: 'Enregistrer',
          themeButton: 'ThÃ¨me',
          languageLabel: 'Langue',
          statusUnknown: 'inconnu',
          statusOk: 'en ligne',
          statusOffline: 'hors ligne',
          bannerConnectionError: 'Erreur de connexion',
          bannerDismiss: 'Fermer',
          projectLabel: 'Projet',
          reloadProjects: 'Actualiser',
          projectInfoNone: 'Aucun projet sÃ©lectionnÃ©',
          projectInfoSelected: 'Projet actuel : {project}',
          debugLabel: 'Debug',
          debugHintOff: 'Afficher les Ã©vÃ©nements Ã©tendus dans le chat',
          debugHintOn: 'Ã‰vÃ©nements Ã©tendus activÃ©s',
          startPromptLabel: 'Invite initiale',
          startPromptPlaceholder: 'Invite initiale du projet',
          savePrompt: 'Enregistrer l\'invite',
          questionPlaceholder: 'Posez une question (Maj+EntrÃ©e = nouvelle ligne)',
          stopButton: 'ArrÃªter',
          sendButton: 'Envoyer',
          inputHintSend: 'EntrÃ©e pour envoyer',
          inputHintNewline: 'Maj+EntrÃ©e pour nouvelle ligne',
          clearLink: 'Effacer',
          errorLoadProjects: 'Impossible de charger les projets',
          statusSaving: 'Enregistrementâ€¦',
          statusSaved: 'EnregistrÃ©',
          statusError: 'Erreur',
          errorStreaming: 'Erreur de streaming, voir la console.',
          errorNoSSE: 'Ce navigateur ne prend pas en charge SSE.',
          attachmentLabel: 'PiÃ¨ce jointe',
          sourcesTitle: 'Sources',
          roleUser: 'utilisateur',
          roleAssistant: 'assistant',
          roleSystem: 'systÃ¨me',
          roleDebug: 'debug'
        }
      },
      it: {
        name: 'Italiano',
        dir: 'ltr',
        strings: {
          heroTitle: 'Consulente AI per il tuo sito',
          heroSubtitle: 'Integra in pochi minuti un assistente in streaming o un avatar vocale.',
          heroLaunchDemo: 'Apri demo live',
          heroSecondary: 'Vedi opzioni di integrazione',
          embedSectionTitle: 'Opzioni di integrazione del widget',
          embedSectionSubtitle: 'Scegli lo stile di presentazione e copia un codice pronto da incollare sul sito.',
          embedTabFloating: 'Bolla flottante',
          embedTabInline: 'Scheda incorporata',
          embedTabIframe: 'Frame completo',
          embedConfigBase: 'URL di base',
          embedConfigProject: 'Slug del progetto',
          embedConfigAccent: 'Colore di accento',
          embedConfigTheme: 'Tema',
          embedThemeAuto: 'Automatico',
          embedThemeDark: 'Scuro',
          embedThemeLight: 'Chiaro',
          embedCopy: 'Copia snippet',
          avatarSectionTitle: 'Avatar con voce',
          avatarSectionSubtitle: 'Fai parlare i visitatori con un assistente animato che legge le risposte.',
          avatarLangLabel: 'Lingua di riconoscimento',
          avatarVoiceLabel: 'Voce parlata (opzionale)',
          avatarCopy: 'Copia widget',
          avatarPreviewSelect: 'Seleziona un progetto per vedere lâ€™assistente vocale.',
          avatarHintSelectProject: 'Seleziona un progetto per vedere lâ€™assistente vocale.',
          avatarHintLoading: 'Caricamento delle impostazioni vocaliâ€¦',
          avatarHintDisabled: 'Lâ€™assistente vocale Ã¨ disattivato per questo progetto.',
          avatarHintEnabled: 'Lâ€™assistente vocale Ã¨ attivato per questo progetto.',
          avatarHintEnabledModel: 'Lâ€™assistente vocale utilizza il modello {model}.',
          avatarHintError: 'Impossibile caricare le impostazioni vocali.',
          copiedLabel: 'Copiato!',
          chatPreviewTitle: 'Anteprima chat live',
          launcherTitle: 'Assistente IA',
          launcherSubtitle: 'Chiedimi qualsiasi cosa',
          launcherAria: 'Apri chat',
          chatTitle: 'Assistente IA',
          chatSubtitle: 'Pronto ad aiutarti con le tue domande',
          chatClose: 'Chiudi',
          toolbarTitle: 'Widget chat LLM',
          basePlaceholder: 'Base API (opzionale), es. http://host:18000',
          saveButton: 'Salva',
          themeButton: 'Tema',
          languageLabel: 'Lingua',
          statusUnknown: 'sconosciuto',
          statusOk: 'online',
          statusOffline: 'offline',
          bannerConnectionError: 'Errore di connessione',
          bannerDismiss: 'Chiudi',
          projectLabel: 'Progetto',
          reloadProjects: 'Aggiorna',
          projectInfoNone: 'Nessun progetto selezionato',
          projectInfoSelected: 'Progetto corrente: {project}',
          debugLabel: 'Debug',
          debugHintOff: 'Mostra eventi estesi nella chat',
          debugHintOn: 'Eventi estesi attivati',
          startPromptLabel: 'Prompt iniziale',
          startPromptPlaceholder: 'Prompt iniziale del progetto',
          savePrompt: 'Salva prompt',
          questionPlaceholder: 'Fai una domanda (Shift+Invio = nuova riga)',
          stopButton: 'Ferma',
          sendButton: 'Invia',
          inputHintSend: 'Invio per inviare',
          inputHintNewline: 'Shift+Invio per nuova riga',
          clearLink: 'Cancella',
          errorLoadProjects: 'Impossibile caricare i progetti',
          statusSaving: 'Salvataggioâ€¦',
          statusSaved: 'Salvato',
          statusError: 'Errore',
          errorStreaming: 'Errore di streaming, controlla la console.',
          errorNoSSE: 'Questo browser non supporta SSE.',
          attachmentLabel: 'Allegato',
          sourcesTitle: 'Fonti',
          roleUser: 'utente',
          roleAssistant: 'assistente',
          roleSystem: 'sistema',
          roleDebug: 'debug'
        }
      },
      pt: {
        name: 'PortuguÃªs',
        dir: 'ltr',
        strings: {
          heroTitle: 'Consultor IA para o seu site',
          heroSubtitle: 'Incorpore em minutos um assistente em streaming ou um avatar com voz.',
          heroLaunchDemo: 'Abrir demo ao vivo',
          heroSecondary: 'Ver opÃ§Ãµes de incorporaÃ§Ã£o',
          embedSectionTitle: 'OpÃ§Ãµes de incorporaÃ§Ã£o do widget de chat',
          embedSectionSubtitle: 'Escolha o estilo de exibiÃ§Ã£o e copie um snippet pronto para colar no seu site.',
          embedTabFloating: 'Bolha flutuante',
          embedTabInline: 'CartÃ£o embutido',
          embedTabIframe: 'Frame completo',
          embedConfigBase: 'URL base',
          embedConfigProject: 'Slug do projeto',
          embedConfigAccent: 'Cor de destaque',
          embedConfigTheme: 'Tema',
          embedThemeAuto: 'AutomÃ¡tico',
          embedThemeDark: 'Escuro',
          embedThemeLight: 'Claro',
          embedCopy: 'Copiar snippet',
          avatarSectionTitle: 'Avatar com voz',
          avatarSectionSubtitle: 'Permita que os visitantes conversem com um assistente animado que lÃª as respostas.',
          avatarLangLabel: 'Idioma de reconhecimento',
          avatarVoiceLabel: 'Voz de sÃ­ntese (opcional)',
          avatarCopy: 'Copiar widget',
          avatarPreviewSelect: 'Selecione um projeto para prÃ©-visualizar o assistente de voz.',
          avatarHintSelectProject: 'Selecione um projeto para prÃ©-visualizar o assistente de voz.',
          avatarHintLoading: 'Carregando configuraÃ§Ãµes de vozâ€¦',
          avatarHintDisabled: 'O assistente de voz estÃ¡ desativado para este projeto.',
          avatarHintEnabled: 'O assistente de voz estÃ¡ ativado para este projeto.',
          avatarHintEnabledModel: 'O assistente de voz usa o modelo {model}.',
          avatarHintError: 'NÃ£o foi possÃ­vel carregar as configuraÃ§Ãµes de voz.',
          copiedLabel: 'Copiado!',
          chatPreviewTitle: 'PrÃ©-visualizaÃ§Ã£o do chat ao vivo',
          launcherTitle: 'Assistente IA',
          launcherSubtitle: 'Pergunte qualquer coisa',
          launcherAria: 'Abrir chat',
          chatTitle: 'Assistente IA',
          chatSubtitle: 'Pronto para ajudar com suas dÃºvidas',
          chatClose: 'Fechar',
          toolbarTitle: 'Widget de chat LLM',
          basePlaceholder: 'Base da API (opcional), ex. http://host:18000',
          saveButton: 'Salvar',
          themeButton: 'Tema',
          languageLabel: 'Idioma',
          statusUnknown: 'desconhecido',
          statusOk: 'online',
          statusOffline: 'offline',
          bannerConnectionError: 'Erro de conexÃ£o',
          bannerDismiss: 'Fechar',
          projectLabel: 'Projeto',
          reloadProjects: 'Recarregar',
          projectInfoNone: 'Nenhum projeto selecionado',
          projectInfoSelected: 'Projeto atual: {project}',
          debugLabel: 'DepuraÃ§Ã£o',
          debugHintOff: 'Mostrar eventos estendidos no chat',
          debugHintOn: 'Eventos estendidos ativados',
          startPromptLabel: 'Prompt inicial',
          startPromptPlaceholder: 'Prompt inicial do projeto',
          savePrompt: 'Salvar prompt',
          questionPlaceholder: 'FaÃ§a uma pergunta (Shift+Enter = nova linha)',
          stopButton: 'Parar',
          sendButton: 'Enviar',
          inputHintSend: 'Enter para enviar',
          inputHintNewline: 'Shift+Enter para nova linha',
          clearLink: 'Limpar',
          errorLoadProjects: 'Falha ao carregar projetos',
          statusSaving: 'Salvandoâ€¦',
          statusSaved: 'Salvo',
          statusError: 'Erro',
          errorStreaming: 'Erro de streaming, veja o console.',
          errorNoSSE: 'Este navegador nÃ£o suporta SSE.',
          attachmentLabel: 'Anexo',
          sourcesTitle: 'Fontes',
          roleUser: 'usuÃ¡rio',
          roleAssistant: 'assistente',
          roleSystem: 'sistema',
          roleDebug: 'depuraÃ§Ã£o'
        }
      },
      ru: {
        name: 'Ð ÑƒÑÑÐºÐ¸Ð¹',
        dir: 'ltr',
        strings: {
          heroTitle: 'AIâ€‘ÐºÐ¾Ð½ÑÑƒÐ»ÑŒÑ‚Ð°Ð½Ñ‚ Ð´Ð»Ñ Ð²Ð°ÑˆÐµÐ³Ð¾ ÑÐ°Ð¹Ñ‚Ð°',
          heroSubtitle: 'ÐŸÐ¾Ð´ÐºÐ»ÑŽÑ‡Ð¸Ñ‚Ðµ Ð¿Ð¾Ñ‚Ð¾ÐºÐ¾Ð²Ñ‹Ð¹ Ñ‡Ð°Ñ‚ Ð¸Ð»Ð¸ Ð³Ð¾Ð»Ð¾ÑÐ¾Ð²Ð¾Ð³Ð¾ Ð°Ð²Ð°Ñ‚Ð°Ñ€Ð° Ð·Ð° ÑÑ‡Ð¸Ñ‚Ð°Ð½Ð½Ñ‹Ðµ Ð¼Ð¸Ð½ÑƒÑ‚Ñ‹.',
          heroLaunchDemo: 'ÐžÑ‚ÐºÑ€Ñ‹Ñ‚ÑŒ Ð¶Ð¸Ð²ÑƒÑŽ Ð´ÐµÐ¼Ð¾Ð½ÑÑ‚Ñ€Ð°Ñ†Ð¸ÑŽ',
          heroSecondary: 'ÐŸÐ¾ÑÐ¼Ð¾Ñ‚Ñ€ÐµÑ‚ÑŒ Ð²Ð°Ñ€Ð¸Ð°Ð½Ñ‚Ñ‹ Ð²ÑÑ‚Ð°Ð²ÐºÐ¸',
          embedSectionTitle: 'Ð’Ð°Ñ€Ð¸Ð°Ð½Ñ‚Ñ‹ Ð²ÑÑ‚Ð°Ð²ÐºÐ¸ Ñ‡Ð°Ñ‚-Ð²Ð¸Ð´Ð¶ÐµÑ‚Ð°',
          embedSectionSubtitle: 'Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð¾Ñ„Ð¾Ñ€Ð¼Ð»ÐµÐ½Ð¸Ðµ Ð¸ ÑÐºÐ¾Ð¿Ð¸Ñ€ÑƒÐ¹Ñ‚Ðµ Ð³Ð¾Ñ‚Ð¾Ð²Ñ‹Ð¹ ÐºÐ¾Ð´ Ð´Ð»Ñ ÑÐ²Ð¾ÐµÐ³Ð¾ ÑÐ°Ð¹Ñ‚Ð°.',
          embedTabFloating: 'ÐŸÐ»Ð°Ð²Ð°ÑŽÑ‰Ð°Ñ ÐºÐ½Ð¾Ð¿ÐºÐ°',
          embedTabInline: 'Ð’ÑÑ‚Ñ€Ð¾ÐµÐ½Ð½Ð°Ñ Ð¿Ð°Ð½ÐµÐ»ÑŒ',
          embedTabIframe: 'ÐŸÐ¾Ð»Ð½Ð¾ÑÐºÑ€Ð°Ð½Ð½Ñ‹Ð¹ Ñ„Ñ€ÐµÐ¹Ð¼',
          embedConfigBase: 'Ð‘Ð°Ð·Ð¾Ð²Ñ‹Ð¹ URL',
          embedConfigProject: 'Ð¡Ð»Ð°Ð³ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°',
          embedConfigAccent: 'ÐÐºÑ†ÐµÐ½Ñ‚Ð½Ñ‹Ð¹ Ñ†Ð²ÐµÑ‚',
          embedConfigTheme: 'Ð¢ÐµÐ¼Ð°',
          embedPositionLabel: 'ÐŸÐ¾Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ ÐºÐ½Ð¾Ð¿ÐºÐ¸',
          embedPositionBottomRight: 'Ð¡Ð½Ð¸Ð·Ñƒ ÑÐ¿Ñ€Ð°Ð²Ð°',
          embedPositionBottomLeft: 'Ð¡Ð½Ð¸Ð·Ñƒ ÑÐ»ÐµÐ²Ð°',
          embedPositionTopRight: 'Ð¡Ð²ÐµÑ€Ñ…Ñƒ ÑÐ¿Ñ€Ð°Ð²Ð°',
          embedPositionTopLeft: 'Ð¡Ð²ÐµÑ€Ñ…Ñƒ ÑÐ»ÐµÐ²Ð°',
          embedPositionHint: 'Ð—Ð´ÐµÑÑŒ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð¿Ñ€ÐµÐ´Ð¿Ñ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€ â€” Ð½Ð° ÑÐ°Ð¹Ñ‚Ðµ Ð²Ð¸Ð´Ð¶ÐµÑ‚ Ð·Ð°ÐºÑ€ÐµÐ¿Ð¸Ñ‚ÑÑ Ð² ÑƒÐ³Ð»Ñƒ.',
          embedThemeAuto: 'ÐÐ²Ñ‚Ð¾',
          embedThemeDark: 'Ð¢Ñ‘Ð¼Ð½Ð°Ñ',
          embedThemeLight: 'Ð¡Ð²ÐµÑ‚Ð»Ð°Ñ',
          embedCopy: 'Ð¡ÐºÐ¾Ð¿Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ ÐºÐ¾Ð´',
          avatarSectionTitle: 'Ð“Ð¾Ð»Ð¾ÑÐ¾Ð²Ð¾Ð¹ Ð°Ð²Ð°Ñ‚Ð°Ñ€',
          avatarSectionSubtitle: 'Ð”Ð°Ð¹Ñ‚Ðµ Ð¿Ð¾ÑÐµÑ‚Ð¸Ñ‚ÐµÐ»ÑÐ¼ Ð²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ÑÑ‚ÑŒ Ð³Ð¾Ð²Ð¾Ñ€Ð¸Ñ‚ÑŒ Ñ Ð°Ð½Ð¸Ð¼Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ð¼ Ð°ÑÑÐ¸ÑÑ‚ÐµÐ½Ñ‚Ð¾Ð¼ Ð² Ñ€ÐµÐ°Ð»ÑŒÐ½Ð¾Ð¼ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸.',
          avatarLangLabel: 'Ð¯Ð·Ñ‹Ðº Ñ€Ð°ÑÐ¿Ð¾Ð·Ð½Ð°Ð²Ð°Ð½Ð¸Ñ',
          avatarModeLabel: 'Ð ÐµÐ¶Ð¸Ð¼ Ð²Ð·Ð°Ð¸Ð¼Ð¾Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ',
          avatarModeText: 'Ð¢Ð¾Ð»ÑŒÐºÐ¾ Ð¿ÐµÑ€ÐµÐ¿Ð¸ÑÐºÐ°',
          avatarModeVoice: 'ÐŸÐµÑ€ÐµÐ¿Ð¸ÑÐºÐ° + Ð³Ð¾Ð»Ð¾Ñ',
          avatarModeAvatar: 'Ð“Ð¾Ð»Ð¾Ñ + Ð°Ð²Ð°Ñ‚Ð°Ñ€',
          avatarCharacterLabel: 'Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð¿ÐµÑ€ÑÐ¾Ð½Ð°Ð¶Ð°',
          avatarCharacterLunaName: 'Ð›ÑƒÐ½Ð°',
          avatarCharacterLunaDesc: 'Ð”Ð¾Ð±Ñ€Ð¾Ð¶ÐµÐ»Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ð¹ Ð¼ÐµÐ½ÐµÐ´Ð¶ÐµÑ€ Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ¸',
          avatarCharacterAmirName: 'ÐÐ¼Ð¸Ñ€',
          avatarCharacterAmirDesc: 'Ð’Ð´ÑƒÐ¼Ñ‡Ð¸Ð²Ñ‹Ð¹ Ñ‚ÐµÑ…Ð½Ð¸Ñ‡ÐµÑÐºÐ¸Ð¹ ÐºÐ¾Ð½ÑÑƒÐ»ÑŒÑ‚Ð°Ð½Ñ‚',
          avatarCharacterSofiaName: 'Ð¡Ð¾Ñ„Ð¸Ñ',
          avatarCharacterSofiaDesc: 'Ð£Ð²ÐµÑ€ÐµÐ½Ð½Ñ‹Ð¹ Ñ€ÑƒÐºÐ¾Ð²Ð¾Ð´Ð¸Ñ‚ÐµÐ»ÑŒ Ð¿Ñ€Ð¾Ð´Ð°Ð¶',
          avatarCharacterNovaName: 'ÐÐ¾Ð²Ð°',
          avatarCharacterNovaDesc: 'Ð­Ð¼Ð¿Ð°Ñ‚Ð¸Ñ‡Ð½Ñ‹Ð¹ Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚Ð¾Ð²Ñ‹Ð¹ ÑÐºÑÐ¿ÐµÑ€Ñ‚',
          avatarCharacterAtlasName: 'ÐÑ‚Ð»Ð°Ñ',
          avatarCharacterAtlasDesc: 'Ð¡Ð¿Ð¾ÐºÐ¾Ð¹Ð½Ñ‹Ð¹ Ð¸Ð½Ð¶ÐµÐ½ÐµÑ€ Ð¿Ð¾ Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸ÑÐ¼',
          avatarCharacterCosmoName: 'ÐšÐ¾ÑÐ¼Ð¾',
          avatarCharacterCosmoDesc: 'Ð¤ÑƒÑ‚ÑƒÑ€Ð¸ÑÑ‚Ð¸Ñ‡Ð½Ñ‹Ð¹ Ð¿Ñ€Ð¾Ð²Ð¾Ð´Ð½Ð¸Ðº',
          avatarCharacterIvanName: 'Ð˜Ð²Ð°Ð½ Ð˜Ð²Ð°Ð½Ñ‹Ñ‡',
          avatarCharacterIvanDesc: '3D-Ð½Ð°ÑÑ‚Ð°Ð²Ð½Ð¸Ðº, ÑƒÐ²ÐµÑ€ÐµÐ½Ð½Ð¾ Ð²ÐµÐ´Ñ‘Ñ‚ Ð´Ð¸Ð°Ð»Ð¾Ð³',
          avatarVoiceLabel: 'Ð“Ð¾Ð»Ð¾Ñ ÑÐ¸Ð½Ñ‚ÐµÐ·Ð° (Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾)',
          avatarSpeechRateLabel: 'Ð¡ÐºÐ¾Ñ€Ð¾ÑÑ‚ÑŒ Ð¾Ð·Ð²ÑƒÑ‡Ð¸Ð²Ð°Ð½Ð¸Ñ',
          avatarTestPlaceholder: 'Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ ÐºÐ¾Ñ€Ð¾Ñ‚ÐºÐ¸Ð¹ Ñ‚ÐµÐºÑÑ‚, Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð¿Ñ€Ð¾ÑÐ»ÑƒÑˆÐ°Ñ‚ÑŒ Ð¿Ñ€Ð¸Ð¼ÐµÑ€â€¦',
          avatarTestButton: 'ÐŸÑ€Ð¾ÑÐ»ÑƒÑˆÐ°Ñ‚ÑŒ',
          avatarCopy: 'Ð¡ÐºÐ¾Ð¿Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð²Ð¸Ð´Ð¶ÐµÑ‚',
          avatarPreviewSelect: 'Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð¿Ñ€Ð¾ÐµÐºÑ‚, Ñ‡Ñ‚Ð¾Ð±Ñ‹ ÑƒÐ²Ð¸Ð´ÐµÑ‚ÑŒ Ð³Ð¾Ð»Ð¾ÑÐ¾Ð²Ð¾Ð³Ð¾ Ð°ÑÑÐ¸ÑÑ‚ÐµÐ½Ñ‚Ð°.',
          avatarHintSelectProject: 'Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð¿Ñ€Ð¾ÐµÐºÑ‚, Ñ‡Ñ‚Ð¾Ð±Ñ‹ ÑƒÐ²Ð¸Ð´ÐµÑ‚ÑŒ Ð³Ð¾Ð»Ð¾ÑÐ¾Ð²Ð¾Ð³Ð¾ Ð°ÑÑÐ¸ÑÑ‚ÐµÐ½Ñ‚Ð°.',
          avatarHintLoading: 'Ð—Ð°Ð³Ñ€ÑƒÐ¶Ð°ÐµÐ¼ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸ Ð³Ð¾Ð»Ð¾ÑÐ¾Ð²Ð¾Ð³Ð¾ Ñ€ÐµÐ¶Ð¸Ð¼Ð°â€¦',
          avatarHintDisabled: 'Ð“Ð¾Ð»Ð¾ÑÐ¾Ð²Ð¾Ð¹ Ð°ÑÑÐ¸ÑÑ‚ÐµÐ½Ñ‚ Ð¾Ñ‚ÐºÐ»ÑŽÑ‡Ñ‘Ð½ Ð´Ð»Ñ ÑÑ‚Ð¾Ð³Ð¾ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°.',
          avatarHintEnabled: 'Ð“Ð¾Ð»Ð¾ÑÐ¾Ð²Ð¾Ð¹ Ð°ÑÑÐ¸ÑÑ‚ÐµÐ½Ñ‚ Ð²ÐºÐ»ÑŽÑ‡Ñ‘Ð½ Ð´Ð»Ñ ÑÑ‚Ð¾Ð³Ð¾ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°.',
          avatarHintEnabledModel: 'Ð“Ð¾Ð»Ð¾ÑÐ¾Ð²Ð¾Ð¹ Ð°ÑÑÐ¸ÑÑ‚ÐµÐ½Ñ‚ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ Ð¼Ð¾Ð´ÐµÐ»ÑŒ {model}.',
          avatarHintError: 'ÐÐµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ Ð·Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚ÑŒ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸ Ð³Ð¾Ð»Ð¾ÑÐ¾Ð²Ð¾Ð³Ð¾ Ñ€ÐµÐ¶Ð¸Ð¼Ð°.',
          avatarHintTextMode: 'ÐÐºÑ‚Ð¸Ð²ÐµÐ½ Ñ€ÐµÐ¶Ð¸Ð¼ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð¿ÐµÑ€ÐµÐ¿Ð¸ÑÐºÐ¸. ÐŸÐ¾ÑÐµÑ‚Ð¸Ñ‚ÐµÐ»Ð¸ Ð±ÑƒÐ´ÑƒÑ‚ Ð¿Ð¸ÑÐ°Ñ‚ÑŒ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ Ð²Ð¼ÐµÑÑ‚Ð¾ Ð³Ð¾Ð»Ð¾ÑÐ¾Ð²Ñ‹Ñ… Ð·Ð°Ð¿Ñ€Ð¾ÑÐ¾Ð².',
          avatarHintAvatarMode: 'Ð’ÐºÐ»ÑŽÑ‡Ñ‘Ð½ Ñ€ÐµÐ¶Ð¸Ð¼ Ñ Ð²Ð¸Ð·ÑƒÐ°Ð»ÑŒÐ½Ñ‹Ð¼ Ð°Ð²Ð°Ñ‚Ð°Ñ€Ð¾Ð¼. ÐŸÐµÑ€ÑÐ¾Ð½Ð°Ð¶ Ð¾Ñ‚Ð¾Ð±Ñ€Ð°Ð¶Ð°ÐµÑ‚ Ð¾Ñ‚Ð²ÐµÑ‚Ñ‹ Ð¿Ð¾Ð¼Ð¾Ñ‰Ð½Ð¸ÐºÐ°.',
          avatarHintAvatarAppend: 'ÐÐ²Ð°Ñ‚Ð°Ñ€ ÑÐ¾Ð¿Ñ€Ð¾Ð²Ð¾Ð¶Ð´Ð°ÐµÑ‚ Ð³Ð¾Ð»Ð¾ÑÐ¾Ð²Ñ‹Ðµ Ð¾Ñ‚Ð²ÐµÑ‚Ñ‹.',
          copiedLabel: 'Ð¡ÐºÐ¾Ð¿Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¾!',
          chatPreviewTitle: 'ÐŸÑ€ÐµÐ´Ð¿Ñ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€ Ð¶Ð¸Ð²Ð¾Ð³Ð¾ Ñ‡Ð°Ñ‚Ð°',
          launcherTitle: 'AIâ€‘Ð¿Ð¾Ð¼Ð¾Ñ‰Ð½Ð¸Ðº',
          launcherSubtitle: 'Ð¡Ð¿Ñ€Ð¾ÑÐ¸Ñ‚Ðµ Ð¼ÐµÐ½Ñ Ð¾ Ñ‡Ñ‘Ð¼ ÑƒÐ³Ð¾Ð´Ð½Ð¾',
          launcherAria: 'ÐžÑ‚ÐºÑ€Ñ‹Ñ‚ÑŒ Ñ‡Ð°Ñ‚',
          chatTitle: 'AIâ€‘Ð¿Ð¾Ð¼Ð¾Ñ‰Ð½Ð¸Ðº',
          chatSubtitle: 'Ð“Ð¾Ñ‚Ð¾Ð² Ð¾Ñ‚Ð²ÐµÑ‚Ð¸Ñ‚ÑŒ Ð½Ð° Ð²Ð°ÑˆÐ¸ Ð²Ð¾Ð¿Ñ€Ð¾ÑÑ‹',
          chatClose: 'Ð—Ð°ÐºÑ€Ñ‹Ñ‚ÑŒ',
          toolbarTitle: 'LLM Ñ‡Ð°Ñ‚â€‘Ð²Ð¸Ð´Ð¶ÐµÑ‚',
          basePlaceholder: 'Ð‘Ð°Ð·Ð° API (Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾), Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€ http://host:18000',
          saveButton: 'Ð¡Ð¾Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ÑŒ',
          themeButton: 'Ð¢ÐµÐ¼Ð°',
          languageLabel: 'Ð¯Ð·Ñ‹Ðº',
          statusUnknown: 'Ð½ÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾',
          statusOk: 'Ð² ÑÐµÑ‚Ð¸',
          statusOffline: 'Ð½Ðµ Ð² ÑÐµÑ‚Ð¸',
          bannerConnectionError: 'ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ñ',
          bannerDismiss: 'Ð—Ð°ÐºÑ€Ñ‹Ñ‚ÑŒ',
          authTitle: 'Ð’Ñ…Ð¾Ð´ Ð°Ð´Ð¼Ð¸Ð½Ð¸ÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€Ð°',
          authPrompt: 'Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ ÑƒÑ‡Ñ‘Ñ‚Ð½Ñ‹Ðµ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð°Ð´Ð¼Ð¸Ð½Ð¸ÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€Ð°, Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð¿Ñ€Ð¾Ð´Ð¾Ð»Ð¶Ð¸Ñ‚ÑŒ.',
          authHint: 'Ð£Ñ‡Ñ‘Ñ‚Ð½Ñ‹Ðµ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð±ÑƒÐ´ÑƒÑ‚ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ñ‹ Ð½Ð° {host}.',
          authUsernameLabel: 'Ð›Ð¾Ð³Ð¸Ð½',
          authUsernamePlaceholder: 'Ð˜Ð¼Ñ Ð°Ð´Ð¼Ð¸Ð½Ð¸ÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€Ð°',
          authPasswordLabel: 'ÐŸÐ°Ñ€Ð¾Ð»ÑŒ',
          authPasswordPlaceholder: 'ÐŸÐ°Ñ€Ð¾Ð»ÑŒ Ð°Ð´Ð¼Ð¸Ð½Ð¸ÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€Ð°',
          authSubmit: 'Ð’Ð¾Ð¹Ñ‚Ð¸',
          authCancel: 'ÐžÑ‚Ð¼ÐµÐ½Ð°',
          authStatusChecking: 'ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼ Ð´Ð°Ð½Ð½Ñ‹Ðµâ€¦',
          authErrorMissing: 'Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ð»Ð¾Ð³Ð¸Ð½ Ð¸ Ð¿Ð°Ñ€Ð¾Ð»ÑŒ',
          authErrorInvalid: 'ÐÐµÐ²ÐµÑ€Ð½Ñ‹Ðµ ÑƒÑ‡Ñ‘Ñ‚Ð½Ñ‹Ðµ Ð´Ð°Ð½Ð½Ñ‹Ðµ',
          authErrorNetwork: 'ÐÐµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ Ð¿Ñ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ ÑƒÑ‡Ñ‘Ñ‚Ð½Ñ‹Ðµ Ð´Ð°Ð½Ð½Ñ‹Ðµ',
          errorAuthRequired: 'ÐÑƒÐ¶ÐµÐ½ Ð²Ñ…Ð¾Ð´ Ð°Ð´Ð¼Ð¸Ð½Ð¸ÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€Ð°',
          projectLabel: 'ÐŸÑ€Ð¾ÐµÐºÑ‚',
          reloadProjects: 'ÐžÐ±Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ',
          projectInfoNone: 'ÐŸÑ€Ð¾ÐµÐºÑ‚ Ð½Ðµ Ð²Ñ‹Ð±Ñ€Ð°Ð½',
          projectInfoSelected: 'Ð¢ÐµÐºÑƒÑ‰Ð¸Ð¹ Ð¿Ñ€Ð¾ÐµÐºÑ‚: {project}',
          debugLabel: 'ÐžÑ‚Ð»Ð°Ð´ÐºÐ°',
          debugHintOff: 'ÐŸÐ¾ÐºÐ°Ð·Ñ‹Ð²Ð°Ñ‚ÑŒ Ñ€Ð°ÑÑˆÐ¸Ñ€ÐµÐ½Ð½Ñ‹Ðµ ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ñ Ð² Ñ‡Ð°Ñ‚Ðµ',
          debugHintOn: 'Ð Ð°ÑÑˆÐ¸Ñ€ÐµÐ½Ð½Ñ‹Ðµ ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ñ Ð²ÐºÐ»ÑŽÑ‡ÐµÐ½Ñ‹',
          startPromptLabel: 'Ð¡Ñ‚Ð°Ñ€Ñ‚Ð¾Ð²Ñ‹Ð¹ Ð¿Ñ€Ð¾Ð¼Ñ‚',
          startPromptPlaceholder: 'Ð¡Ñ‚Ð°Ñ€Ñ‚Ð¾Ð²Ñ‹Ð¹ Ð¿Ñ€Ð¾Ð¼Ñ‚ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°',
          savePrompt: 'Ð¡Ð¾Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ÑŒ Ð¿Ñ€Ð¾Ð¼Ñ‚',
          questionPlaceholder: 'Ð—Ð°Ð´Ð°Ð¹Ñ‚Ðµ Ð²Ð¾Ð¿Ñ€Ð¾Ñ (Shift+Enter = Ð½Ð¾Ð²Ð°Ñ ÑÑ‚Ñ€Ð¾ÐºÐ°)',
          stopButton: 'Ð¡Ñ‚Ð¾Ð¿',
          sendButton: 'ÐžÑ‚Ð¿Ñ€Ð°Ð²Ð¸Ñ‚ÑŒ',
          inputHintSend: 'Enter â€” Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð¸Ñ‚ÑŒ',
          inputHintNewline: 'Shift+Enter â€” Ð½Ð¾Ð²Ð°Ñ ÑÑ‚Ñ€Ð¾ÐºÐ°',
          clearLink: 'ÐžÑ‡Ð¸ÑÑ‚Ð¸Ñ‚ÑŒ',
          errorLoadProjects: 'ÐÐµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ Ð·Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚ÑŒ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ñ‹',
          statusSaving: 'Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ðµâ€¦',
          statusSaved: 'Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¾',
          statusError: 'ÐžÑˆÐ¸Ð±ÐºÐ°',
          errorStreaming: 'ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ð¾Ñ‚Ð¾ÐºÐ¾Ð²Ð¾Ð¹ Ð¿ÐµÑ€ÐµÐ´Ð°Ñ‡Ð¸, ÑÐ¼Ð¾Ñ‚Ñ€Ð¸Ñ‚Ðµ ÐºÐ¾Ð½ÑÐ¾Ð»ÑŒ.',
          errorNoSSE: 'Ð­Ñ‚Ð¾Ñ‚ Ð±Ñ€Ð°ÑƒÐ·ÐµÑ€ Ð½Ðµ Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶Ð¸Ð²Ð°ÐµÑ‚ SSE.',
          attachmentLabel: 'Ð’Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ',
          sourcesTitle: 'Ð˜ÑÑ‚Ð¾Ñ‡Ð½Ð¸ÐºÐ¸',
          roleUser: 'Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ',
          roleAssistant: 'Ð°ÑÑÐ¸ÑÑ‚ÐµÐ½Ñ‚',
          roleSystem: 'ÑÐ¸ÑÑ‚ÐµÐ¼Ð°',
          roleDebug: 'Ð¾Ñ‚Ð»Ð°Ð´ÐºÐ°'
        }
      },
      zh: {
        name: 'ä¸­æ–‡',
        dir: 'ltr',
        strings: {
          heroTitle: 'ä¸ºä½ çš„ç½‘ç«™æä¾› AI å’¨è¯¢é¡¾é—®',
          heroSubtitle: 'å‡ åˆ†é’Ÿå†…åµŒå…¥æµå¼èŠå¤©æˆ–è¯­éŸ³å¤´åƒåŠ©æ‰‹ã€‚',
          heroLaunchDemo: 'æ‰“å¼€å®žæ—¶æ¼”ç¤º',
          heroSecondary: 'æŸ¥çœ‹åµŒå…¥é€‰é¡¹',
          embedSectionTitle: 'èŠå¤©ç»„ä»¶åµŒå…¥é€‰é¡¹',
          embedSectionSubtitle: 'é€‰æ‹©å‘ˆçŽ°æ–¹å¼ï¼Œå¹¶å¤åˆ¶å¯ç›´æŽ¥ç²˜è´´çš„ä»£ç ã€‚',
          embedTabFloating: 'æµ®åŠ¨æ°”æ³¡',
          embedTabInline: 'å†…åµŒå¡ç‰‡',
          embedTabIframe: 'æ•´é¡µæ¡†æž¶',
          embedConfigBase: 'åŸºç¡€ URL',
          embedConfigProject: 'é¡¹ç›®æ ‡è¯†',
          embedConfigAccent: 'ä¸»è‰²è°ƒ',
          embedConfigTheme: 'ä¸»é¢˜',
          embedThemeAuto: 'è‡ªåŠ¨',
          embedThemeDark: 'æ·±è‰²',
          embedThemeLight: 'æµ…è‰²',
          embedCopy: 'å¤åˆ¶ä»£ç æ®µ',
          avatarSectionTitle: 'è¯­éŸ³å¤´åƒ',
          avatarSectionSubtitle: 'è®©è®¿å®¢ä¸Žä¼šè¯´è¯çš„åŠ¨ç”»åŠ©æ‰‹å®žæ—¶å¯¹è¯ã€‚',
          avatarLangLabel: 'è¯†åˆ«è¯­è¨€',
          avatarVoiceLabel: 'åˆæˆè¯­éŸ³ï¼ˆå¯é€‰ï¼‰',
          avatarCopy: 'å¤åˆ¶å°ç»„ä»¶',
          avatarPreviewSelect: 'é€‰æ‹©ä¸€ä¸ªé¡¹ç›®ä»¥é¢„è§ˆè¯­éŸ³åŠ©æ‰‹ã€‚',
          avatarHintSelectProject: 'é€‰æ‹©ä¸€ä¸ªé¡¹ç›®ä»¥é¢„è§ˆè¯­éŸ³åŠ©æ‰‹ã€‚',
          avatarHintLoading: 'æ­£åœ¨åŠ è½½è¯­éŸ³è®¾ç½®â€¦',
          avatarHintDisabled: 'æ­¤é¡¹ç›®å·²ç¦ç”¨è¯­éŸ³åŠ©æ‰‹ã€‚',
          avatarHintEnabled: 'æ­¤é¡¹ç›®å·²å¯ç”¨è¯­éŸ³åŠ©æ‰‹ã€‚',
          avatarHintEnabledModel: 'è¯­éŸ³åŠ©æ‰‹ä½¿ç”¨æ¨¡åž‹ {model}ã€‚',
          avatarHintError: 'æ— æ³•åŠ è½½è¯­éŸ³è®¾ç½®ã€‚',
          copiedLabel: 'å·²å¤åˆ¶ï¼',
          chatPreviewTitle: 'å®žæ—¶èŠå¤©é¢„è§ˆ',
          launcherTitle: 'AI åŠ©æ‰‹',
          launcherSubtitle: 'éšæ—¶å‘æˆ‘æé—®',
          launcherAria: 'æ‰“å¼€èŠå¤©',
          chatTitle: 'AI åŠ©æ‰‹',
          chatSubtitle: 'éšæ—¶ä¸ºæ‚¨è§£ç­”é—®é¢˜',
          chatClose: 'å…³é—­',
          toolbarTitle: 'LLM èŠå¤©ç»„ä»¶',
          basePlaceholder: 'API åœ°å€ï¼ˆå¯é€‰ï¼‰ï¼Œä¾‹å¦‚ http://host:18000',
          saveButton: 'ä¿å­˜',
          themeButton: 'ä¸»é¢˜',
          languageLabel: 'è¯­è¨€',
          statusUnknown: 'æœªçŸ¥',
          statusOk: 'åœ¨çº¿',
          statusOffline: 'ç¦»çº¿',
          bannerConnectionError: 'è¿žæŽ¥é”™è¯¯',
          bannerDismiss: 'å…³é—­',
          projectLabel: 'é¡¹ç›®',
          reloadProjects: 'åˆ·æ–°',
          projectInfoNone: 'æœªé€‰æ‹©é¡¹ç›®',
          projectInfoSelected: 'å½“å‰é¡¹ç›®ï¼š{project}',
          debugLabel: 'è°ƒè¯•',
          debugHintOff: 'åœ¨èŠå¤©ä¸­æ˜¾ç¤ºæ‰©å±•äº‹ä»¶',
          debugHintOn: 'å·²å¯ç”¨æ‰©å±•äº‹ä»¶',
          startPromptLabel: 'åˆå§‹æç¤º',
          startPromptPlaceholder: 'é¡¹ç›®åˆå§‹æç¤º',
          savePrompt: 'ä¿å­˜æç¤º',
          questionPlaceholder: 'æé—®ï¼ˆShift+Enter = æ¢è¡Œï¼‰',
          stopButton: 'åœæ­¢',
          sendButton: 'å‘é€',
          inputHintSend: 'å›žè½¦å‘é€',
          inputHintNewline: 'Shift+Enter æ¢è¡Œ',
          clearLink: 'æ¸…é™¤',
          errorLoadProjects: 'é¡¹ç›®åŠ è½½å¤±è´¥',
          statusSaving: 'ä¿å­˜ä¸­â€¦',
          statusSaved: 'å·²ä¿å­˜',
          statusError: 'é”™è¯¯',
          errorStreaming: 'æµå¼ä¼ è¾“é”™è¯¯ï¼Œè¯·æŸ¥çœ‹æŽ§åˆ¶å°ã€‚',
          errorNoSSE: 'æ­¤æµè§ˆå™¨ä¸æ”¯æŒ SSEã€‚',
          attachmentLabel: 'é™„ä»¶',
          sourcesTitle: 'æ¥æº',
          roleUser: 'ç”¨æˆ·',
          roleAssistant: 'åŠ©æ‰‹',
          roleSystem: 'ç³»ç»Ÿ',
          roleDebug: 'è°ƒè¯•'
        }
      },
      ja: {
        name: 'æ—¥æœ¬èªž',
        dir: 'ltr',
        strings: {
          heroTitle: 'ã‚ãªãŸã®ã‚µã‚¤ãƒˆã®ãŸã‚ã®AIã‚³ãƒ³ã‚µãƒ«ã‚¿ãƒ³ãƒˆ',
          heroSubtitle: 'æ•°åˆ†ã§ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ãƒãƒ£ãƒƒãƒˆã‚„éŸ³å£°ã‚¢ãƒã‚¿ãƒ¼ã‚’åŸ‹ã‚è¾¼ã‚ã¾ã™ã€‚',
          heroLaunchDemo: 'ãƒ©ã‚¤ãƒ–ãƒ‡ãƒ¢ã‚’é–‹ã',
          heroSecondary: 'åŸ‹ã‚è¾¼ã¿ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’è¦‹ã‚‹',
          embedSectionTitle: 'ãƒãƒ£ãƒƒãƒˆã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆã®åŸ‹ã‚è¾¼ã¿ã‚ªãƒ—ã‚·ãƒ§ãƒ³',
          embedSectionSubtitle: 'ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã‚’é¸ã³ã€ã™ãã«è²¼ã‚Šä»˜ã‘ã‚‰ã‚Œã‚‹ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã—ã‚‡ã†ã€‚',
          embedTabFloating: 'ãƒ•ãƒ­ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒãƒ–ãƒ«',
          embedTabInline: 'ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ã‚«ãƒ¼ãƒ‰',
          embedTabIframe: 'ãƒ•ãƒ«ãƒ•ãƒ¬ãƒ¼ãƒ ',
          embedConfigBase: 'ãƒ™ãƒ¼ã‚¹URL',
          embedConfigProject: 'ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚¹ãƒ©ãƒƒã‚°',
          embedConfigAccent: 'ã‚¢ã‚¯ã‚»ãƒ³ãƒˆã‚«ãƒ©ãƒ¼',
          embedConfigTheme: 'ãƒ†ãƒ¼ãƒž',
          embedThemeAuto: 'è‡ªå‹•',
          embedThemeDark: 'ãƒ€ãƒ¼ã‚¯',
          embedThemeLight: 'ãƒ©ã‚¤ãƒˆ',
          embedCopy: 'ã‚¹ãƒ‹ãƒšãƒƒãƒˆã‚’ã‚³ãƒ”ãƒ¼',
          avatarSectionTitle: 'éŸ³å£°ã‚¢ãƒã‚¿ãƒ¼',
          avatarSectionSubtitle: 'è¨ªå•è€…ãŒã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆã¨ä¼šè©±ã—ã€éŸ³å£°ã§å›žç­”ã‚’èžã‘ã¾ã™ã€‚',
          avatarLangLabel: 'èªè­˜è¨€èªž',
          avatarVoiceLabel: 'èª­ã¿ä¸Šã’éŸ³å£°(ä»»æ„)',
          avatarCopy: 'ã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆã‚’ã‚³ãƒ”ãƒ¼',
          avatarPreviewSelect: 'éŸ³å£°ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆã‚’è¡¨ç¤ºã™ã‚‹ã«ã¯ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’é¸æŠžã—ã¦ãã ã•ã„ã€‚',
          avatarHintSelectProject: 'éŸ³å£°ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆã‚’è¡¨ç¤ºã™ã‚‹ã«ã¯ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’é¸æŠžã—ã¦ãã ã•ã„ã€‚',
          avatarHintLoading: 'éŸ³å£°è¨­å®šã‚’èª­ã¿è¾¼ã¿ä¸­â€¦',
          avatarHintDisabled: 'ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯éŸ³å£°ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆãŒç„¡åŠ¹ã§ã™ã€‚',
          avatarHintEnabled: 'ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯éŸ³å£°ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆãŒæœ‰åŠ¹ã§ã™ã€‚',
          avatarHintEnabledModel: 'éŸ³å£°ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆã¯ {model} ãƒ¢ãƒ‡ãƒ«ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚',
          avatarHintError: 'éŸ³å£°è¨­å®šã‚’èª­ã¿è¾¼ã‚ã¾ã›ã‚“ã§ã—ãŸã€‚',
          copiedLabel: 'ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼',
          chatPreviewTitle: 'ãƒ©ã‚¤ãƒ–ãƒãƒ£ãƒƒãƒˆãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼',
          launcherTitle: 'AIã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ',
          launcherSubtitle: 'ä½•ã§ã‚‚èžã„ã¦ãã ã•ã„',
          launcherAria: 'ãƒãƒ£ãƒƒãƒˆã‚’é–‹ã',
          chatTitle: 'AIã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ',
          chatSubtitle: 'ã”è³ªå•ã«ãŠç­”ãˆã—ã¾ã™',
          chatClose: 'é–‰ã˜ã‚‹',
          toolbarTitle: 'LLMãƒãƒ£ãƒƒãƒˆã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆ',
          basePlaceholder: 'APIãƒ™ãƒ¼ã‚¹ï¼ˆä»»æ„ï¼‰ã€ä¾‹: http://host:18000',
          saveButton: 'ä¿å­˜',
          themeButton: 'ãƒ†ãƒ¼ãƒž',
          languageLabel: 'è¨€èªž',
          statusUnknown: 'ä¸æ˜Ž',
          statusOk: 'ã‚ªãƒ³ãƒ©ã‚¤ãƒ³',
          statusOffline: 'ã‚ªãƒ•ãƒ©ã‚¤ãƒ³',
          bannerConnectionError: 'æŽ¥ç¶šã‚¨ãƒ©ãƒ¼',
          bannerDismiss: 'é–‰ã˜ã‚‹',
          projectLabel: 'ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ',
          reloadProjects: 'å†èª­ã¿è¾¼ã¿',
          projectInfoNone: 'ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãŒé¸æŠžã•ã‚Œã¦ã„ã¾ã›ã‚“',
          projectInfoSelected: 'ç¾åœ¨ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ: {project}',
          debugLabel: 'ãƒ‡ãƒãƒƒã‚°',
          debugHintOff: 'ãƒãƒ£ãƒƒãƒˆã§æ‹¡å¼µã‚¤ãƒ™ãƒ³ãƒˆã‚’è¡¨ç¤ºã™ã‚‹',
          debugHintOn: 'æ‹¡å¼µã‚¤ãƒ™ãƒ³ãƒˆãŒæœ‰åŠ¹ã§ã™',
          startPromptLabel: 'åˆæœŸãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ',
          startPromptPlaceholder: 'ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®åˆæœŸãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ',
          savePrompt: 'ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ä¿å­˜',
          questionPlaceholder: 'è³ªå•ã‚’å…¥åŠ› (Shift+Enter ã§æ”¹è¡Œ)',
          stopButton: 'åœæ­¢',
          sendButton: 'é€ä¿¡',
          inputHintSend: 'Enter ã§é€ä¿¡',
          inputHintNewline: 'Shift+Enter ã§æ”¹è¡Œ',
          clearLink: 'ã‚¯ãƒªã‚¢',
          errorLoadProjects: 'ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’èª­ã¿è¾¼ã‚ã¾ã›ã‚“ã§ã—ãŸ',
          statusSaving: 'ä¿å­˜ä¸­â€¦',
          statusSaved: 'ä¿å­˜ã—ã¾ã—ãŸ',
          statusError: 'ã‚¨ãƒ©ãƒ¼',
          errorStreaming: 'ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ã‚¨ãƒ©ãƒ¼ã€‚ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚',
          errorNoSSE: 'ã“ã®ãƒ–ãƒ©ã‚¦ã‚¶ã¯ SSE ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã›ã‚“ã€‚',
          attachmentLabel: 'æ·»ä»˜ãƒ•ã‚¡ã‚¤ãƒ«',
          sourcesTitle: 'å‡ºå…¸',
          roleUser: 'ãƒ¦ãƒ¼ã‚¶ãƒ¼',
          roleAssistant: 'ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ',
          roleSystem: 'ã‚·ã‚¹ãƒ†ãƒ ',
          roleDebug: 'ãƒ‡ãƒãƒƒã‚°'
        }
      },
      ar: {
        name: 'Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©',
        dir: 'rtl',
        strings: {
          heroTitle: 'Ù…Ø³ØªØ´Ø§Ø± Ø°ÙƒØ§Ø¡ Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ù„Ù…ÙˆÙ‚Ø¹Ùƒ',
          heroSubtitle: 'Ø£Ø¶Ù Ù…Ø­Ø§Ø¯Ø«Ø© Ù…ØªØ¯ÙÙ‚Ø© Ø£Ùˆ ØµÙˆØ±Ø© Ø±Ù…Ø²ÙŠØ© ØµÙˆØªÙŠØ© ÙÙŠ Ø¯Ù‚Ø§Ø¦Ù‚.',
          heroLaunchDemo: 'ÙØªØ­ Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø¨Ø§Ø´Ø±',
          heroSecondary: 'Ø¹Ø±Ø¶ Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ø¯Ù…Ø¬',
          embedSectionTitle: 'Ø®ÙŠØ§Ø±Ø§Øª ØªØ¶Ù…ÙŠÙ† ÙˆØ¯Ø¬Øª Ø§Ù„Ø¯Ø±Ø¯Ø´Ø©',
          embedSectionSubtitle: 'Ø§Ø®ØªØ± Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¹Ø±Ø¶ Ùˆ Ø§Ù†Ø³Ø® Ø§Ù„Ø´ÙŠÙØ±Ø© Ø§Ù„Ø¬Ø§Ù‡Ø²Ø© Ù„Ù…ÙˆÙ‚Ø¹Ùƒ.',
          embedTabFloating: 'ÙÙ‚Ø§Ø¹Ø© Ø¹Ø§Ø¦Ù…Ø©',
          embedTabInline: 'Ø¨Ø·Ø§Ù‚Ø© Ù…Ø¯Ù…Ø¬Ø©',
          embedTabIframe: 'Ø¥Ø·Ø§Ø± ÙƒØ§Ù…Ù„',
          embedConfigBase: 'Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ',
          embedConfigProject: 'Ù…ÙØ¹Ø±Ù‘Ù Ø§Ù„Ù…Ø´Ø±ÙˆØ¹',
          embedConfigAccent: 'Ù„ÙˆÙ† Ø§Ù„ØªÙ…ÙŠÙŠØ²',
          embedConfigTheme: 'Ø§Ù„Ø³Ù…Ø©',
          embedThemeAuto: 'ØªÙ„Ù‚Ø§Ø¦ÙŠ',
          embedThemeDark: 'Ø¯Ø§ÙƒÙ†',
          embedThemeLight: 'ÙØ§ØªØ­',
          embedCopy: 'Ù†Ø³Ø® Ø§Ù„Ø´ÙŠÙØ±Ø©',
          avatarSectionTitle: 'ØµÙˆØ±Ø© Ø±Ù…Ø²ÙŠØ© Ø¨Ø§Ù„ØµÙˆØª',
          avatarSectionSubtitle: 'Ø§Ø³Ù…Ø­ Ù„Ù„Ø²ÙˆØ§Ø± Ø¨Ø§Ù„ØªØ­Ø¯Ø« Ù…Ø¹ Ù…Ø³Ø§Ø¹Ø¯ Ù…ØªØ­Ø±Ùƒ ÙŠØ¬ÙŠØ¨ Ø¨ØµÙˆØª Ø­ÙŠ.',
          avatarLangLabel: 'Ù„ØºØ© Ø§Ù„ØªØ¹Ø±Ù',
          avatarVoiceLabel: 'ØµÙˆØª Ø§Ù„Ù‚Ø±Ø§Ø¡Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)',
          avatarCopy: 'Ù†Ø³Ø® Ø§Ù„ÙˆØ¯Ø¬Øª',
          avatarPreviewSelect: 'Ø§Ø®ØªØ± Ù…Ø´Ø±ÙˆØ¹Ù‹Ø§ Ù„Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© Ù„Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„ØµÙˆØªÙŠ.',
          avatarHintSelectProject: 'Ø§Ø®ØªØ± Ù…Ø´Ø±ÙˆØ¹Ù‹Ø§ Ù„Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© Ù„Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„ØµÙˆØªÙŠ.',
          avatarHintLoading: 'Ø¬Ø§Ø±Ù ØªØ­Ù…ÙŠÙ„ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØµÙˆØªâ€¦',
          avatarHintDisabled: 'Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„ØµÙˆØªÙŠ Ù…Ø¹Ø·Ù„ Ù„Ù‡Ø°Ø§ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹.',
          avatarHintEnabled: 'Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„ØµÙˆØªÙŠ Ù…ÙØ¹Ù„ Ù„Ù‡Ø°Ø§ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹.',
          avatarHintEnabledModel: 'Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„ØµÙˆØªÙŠ ÙŠØ³ØªØ®Ø¯Ù… Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ {model}.',
          avatarHintError: 'ØªØ¹Ø°Ø± ØªØ­Ù…ÙŠÙ„ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØµÙˆØª.',
          copiedLabel: 'ØªÙ… Ø§Ù„Ù†Ø³Ø®!',
          chatPreviewTitle: 'Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ø¯Ø±Ø¯Ø´Ø© Ø§Ù„Ø­ÙŠØ©',
          launcherTitle: 'Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ',
          launcherSubtitle: 'Ø§Ø·Ø±Ø­ Ø£ÙŠ Ø³Ø¤Ø§Ù„',
          launcherAria: 'ÙØªØ­ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©',
          chatTitle: 'Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ',
          chatSubtitle: 'Ø¬Ø§Ù‡Ø² Ù„Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø¹Ù† Ø£Ø³Ø¦Ù„ØªÙƒ',
          chatClose: 'Ø¥ØºÙ„Ø§Ù‚',
          toolbarTitle: 'Ø£Ø¯Ø§Ø© Ù…Ø­Ø§Ø¯Ø«Ø© LLM',
          basePlaceholder: 'Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù€ API (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)ØŒ Ù…Ø«Ù„ http://host:18000',
          saveButton: 'Ø­ÙØ¸',
          themeButton: 'Ø§Ù„Ø³Ù…Ø©',
          languageLabel: 'Ø§Ù„Ù„ØºØ©',
          statusUnknown: 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ',
          statusOk: 'Ù…ØªØµÙ„',
          statusOffline: 'ØºÙŠØ± Ù…ØªØµÙ„',
          bannerConnectionError: 'Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„',
          bannerDismiss: 'Ø¥ØºÙ„Ø§Ù‚',
          projectLabel: 'Ø§Ù„Ù…Ø´Ø±ÙˆØ¹',
          reloadProjects: 'ØªØ­Ø¯ÙŠØ«',
          projectInfoNone: 'Ù„Ù… ÙŠØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ù…Ø´Ø±ÙˆØ¹',
          projectInfoSelected: 'Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ø§Ù„Ø­Ø§Ù„ÙŠ: {project}',
          debugLabel: 'ØªØµØ­ÙŠØ­',
          debugHintOff: 'Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ø§Ù„Ù…ÙˆØ³Ø¹Ø© ÙÙŠ Ø§Ù„Ø¯Ø±Ø¯Ø´Ø©',
          debugHintOn: 'ØªÙ… ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ø§Ù„Ù…ÙˆØ³Ø¹Ø©',
          startPromptLabel: 'Ø§Ù„Ù…Ø·Ø§Ù„Ø¨Ø© Ø§Ù„Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠØ©',
          startPromptPlaceholder: 'Ø§Ù„Ù…Ø·Ø§Ù„Ø¨Ø© Ø§Ù„Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠØ© Ù„Ù„Ù…Ø´Ø±ÙˆØ¹',
          savePrompt: 'Ø­ÙØ¸ Ø§Ù„Ù…Ø·Ø§Ù„Ø¨Ø©',
          questionPlaceholder: 'Ø§ÙƒØªØ¨ Ø³Ø¤Ø§Ù„Ùƒ (Shift+Enter = Ø³Ø·Ø± Ø¬Ø¯ÙŠØ¯)',
          stopButton: 'Ø¥ÙŠÙ‚Ø§Ù',
          sendButton: 'Ø¥Ø±Ø³Ø§Ù„',
          inputHintSend: 'Enter Ù„Ù„Ø¥Ø±Ø³Ø§Ù„',
          inputHintNewline: 'Shift+Enter Ù„Ø³Ø·Ø± Ø¬Ø¯ÙŠØ¯',
          clearLink: 'Ù…Ø³Ø­',
          errorLoadProjects: 'ØªØ¹Ø°Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹',
          statusSaving: 'Ø¬Ø§Ø±Ù Ø§Ù„Ø­ÙØ¸â€¦',
          statusSaved: 'ØªÙ… Ø§Ù„Ø­ÙØ¸',
          statusError: 'Ø®Ø·Ø£',
          errorStreaming: 'Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¨Ø«ØŒ Ø±Ø§Ø¬Ø¹ ÙˆØ­Ø¯Ø© Ø§Ù„ØªØ­ÙƒÙ….',
          errorNoSSE: 'Ù‡Ø°Ø§ Ø§Ù„Ù…ØªØµÙØ­ Ù„Ø§ ÙŠØ¯Ø¹Ù… SSE.',
          attachmentLabel: 'Ù…Ø±ÙÙ‚',
          sourcesTitle: 'Ø§Ù„Ù…ØµØ§Ø¯Ø±',
          roleUser: 'Ù…Ø³ØªØ®Ø¯Ù…',
          roleAssistant: 'Ù…Ø³Ø§Ø¹Ø¯',
          roleSystem: 'Ù†Ø¸Ø§Ù…',
          roleDebug: 'ØªØµØ­ÙŠØ­'
        }
      }
    };

    let currentLanguage = (() => {
      try {
        const stored = localStorage.getItem(LANGUAGE_STORAGE_KEY);
        if (stored && LANGUAGES[stored]) {
          return stored;
        }
      } catch { }
      return FALLBACK_LANGUAGE;
    })();

    function t(key) {
      const lang = LANGUAGES[currentLanguage] || LANGUAGES[FALLBACK_LANGUAGE];
      return lang.strings[key] ?? LANGUAGES[FALLBACK_LANGUAGE].strings[key] ?? key;
    }

    function translateRole(role) {
      const normalized = String(role || '').toLowerCase();
      const map = {
        user: 'roleUser',
        assistant: 'roleAssistant',
        system: 'roleSystem',
        debug: 'roleDebug'
      };
      const key = map[normalized];
      return key ? t(key) : normalized;
    }

    function translateStatus(key) {
      const normalized = String(key || '').toLowerCase();
      const map = {
        unknown: 'statusUnknown',
        ok: 'statusOk',
        online: 'statusOk',
        offline: 'statusOffline'
      };
      const target = map[normalized];
      if (target) return t(target);
      return key;
    }

    const AUTH_CANCELLED_CODE = 'AUTH_CANCELLED';
    const adminAuthHeaders = new Map();
    let authModalPromise = null;
    let authModalResolver = null;
    let authModalBase = '';
    const ADMIN_USER_STORAGE_KEY = 'chat_widget_admin_user';

    function getCurrentBaseValue() {
      return (baseUrlInput?.value || '').trim();
    }

    function normalizeAuthBase(base) {
      const raw = (base || '').trim();
      if (!raw) return '';
      return raw.replace(/\/$/, '');
    }

    function getBaseKey(base) {
      const normalized = normalizeAuthBase(base);
      if (!normalized) return window.location.origin;
      try {
        return new URL(normalized).origin;
      } catch {
        try {
          return new URL(normalized, window.location.origin).origin;
        } catch {
          return normalized;
        }
      }
    }

    function buildAdminUrl(path, base) {
      if (/^https?:\/\//i.test(path)) return path;
      const normalized = normalizeAuthBase(base);
      if (!normalized) return path;
      return `${normalized}${path}`;
    }

    function computeAuthHost(base) {
      const normalized = normalizeAuthBase(base);
      if (!normalized) return window.location.origin;
      try {
        return new URL(normalized).origin;
      } catch {
        try {
          return new URL(normalized, window.location.origin).origin;
        } catch {
          return normalized;
        }
      }
    }

    function getStoredAdminUser() {
      try {
        return localStorage.getItem(ADMIN_USER_STORAGE_KEY) || '';
      } catch {
        return '';
      }
    }

    function setStoredAdminUser(username) {
      try {
        if (username) {
          localStorage.setItem(ADMIN_USER_STORAGE_KEY, username);
        } else {
          localStorage.removeItem(ADMIN_USER_STORAGE_KEY);
        }
      } catch { }
    }

    function setAuthErrorKey(key) {
      if (!authError) return;
      if (key) {
        authError.dataset.key = key;
        authError.textContent = t(key);
      } else {
        delete authError.dataset.key;
        authError.textContent = '';
      }
    }

    function setAuthSubmitting(state) {
      if (authSubmitBtn) authSubmitBtn.disabled = state;
      if (authCancelBtn) authCancelBtn.disabled = state;
      if (state) {
        setAuthErrorKey('authStatusChecking');
      } else if (authError && authError.dataset.key === 'authStatusChecking') {
        setAuthErrorKey('');
      }
    }

    function updateAuthHint(base) {
      if (!authHint) return;
      const host = computeAuthHost(base);
      authHint.dataset.host = host;
      authHint.textContent = t('authHint').replace('{host}', host);
    }

    function showAuthModal(base) {
      if (!authModal) return;
      authModalBase = normalizeAuthBase(base);
      updateAuthHint(authModalBase || window.location.origin);
      if (authModal.dataset.visible === 'true') return;
      setAuthSubmitting(false);
      setAuthErrorKey('');
      if (authMessage) authMessage.textContent = t('authPrompt');
      if (authPasswordInput) authPasswordInput.value = '';
      if (authUserInput && !authUserInput.value) {
        const storedUser = getStoredAdminUser();
        if (storedUser) authUserInput.value = storedUser;
      }
      authModal.dataset.visible = 'true';
      document.body.classList.add('modal-open');
      setTimeout(() => {
        authUserInput?.focus();
        authUserInput?.select?.();
      }, 20);
    }

    function hideAuthModal() {
      if (!authModal) return;
      authModal.dataset.visible = 'false';
      document.body.classList.remove('modal-open');
      setAuthSubmitting(false);
    }

    function cancelAuthModal() {
      if (!authModal || authModal.dataset.visible !== 'true') return;
      hideAuthModal();
      if (authModalResolver) authModalResolver(false);
    }

    async function verifyAdminCredentials(base, header) {
      const url = buildAdminUrl('/api/v1/admin/session', base);
      try {
        const response = await fetch(url, {
          headers: { Authorization: header },
          credentials: 'same-origin',
        });
        return { ok: response.ok, status: response.status };
      } catch (error) {
        return { ok: false, status: 0, error };
      }
    }

    function setAuthHeaderForBase(base, header) {
      adminAuthHeaders.set(getBaseKey(base), header);
    }

    function getAuthHeaderForBase(base) {
      return adminAuthHeaders.get(getBaseKey(base)) || null;
    }

    function clearAuthHeaderForBase(base) {
      adminAuthHeaders.delete(getBaseKey(base));
    }

    function requestAdminAuth(base) {
      if (!authModal) return Promise.resolve(false);
      if (authModalPromise) return authModalPromise;
      showAuthModal(base);
      authModalPromise = new Promise((resolve) => {
        authModalResolver = (value) => {
          resolve(Boolean(value));
        };
      }).finally(() => {
        authModalPromise = null;
        authModalResolver = null;
      });
      return authModalPromise;
    }

    function createAuthCancelledError() {
      const error = new Error('admin-auth-cancelled');
      error.code = AUTH_CANCELLED_CODE;
      return error;
    }

    async function fetchAdmin(path, init = {}) {
      const base = normalizeAuthBase(getCurrentBaseValue());
      const url = /^https?:\/\//i.test(path) ? path : buildAdminUrl(path, base);
      const attempt = async () => {
        const headers = new Headers(init.headers || {});
        const token = getAuthHeaderForBase(base);
        if (token && !headers.has('Authorization')) {
          headers.set('Authorization', token);
        }
        const options = { ...init, headers };
        return fetch(url, options);
      };

      let response;
      try {
        response = await attempt();
      } catch (error) {
        throw error;
      }

      if (response.status !== 401) {
        if (response.status === 403) {
          clearAuthHeaderForBase(base);
        }
        return response;
      }

      const authenticated = await requestAdminAuth(base);
      if (!authenticated) {
        throw createAuthCancelledError();
      }

      response = await attempt();
      if (response.status === 401) {
        clearAuthHeaderForBase(base);
      }
      return response;
    }

    function setDesktopStatus(message, state) {
      if (!desktopBuildStatus) return;
      desktopBuildStatus.textContent = message || '';
      if (state) {
        desktopBuildStatus.dataset.state = state;
      } else {
        delete desktopBuildStatus.dataset.state;
      }
    }

    function extractDownloadFilename(contentDisposition, platformKey) {
      if (typeof contentDisposition === 'string' && contentDisposition) {
        const utfMatch = /filename\*=UTF-8''([^;]+)/i.exec(contentDisposition);
        if (utfMatch && utfMatch[1]) {
          try {
            return decodeURIComponent(utfMatch[1]);
          } catch {
            return utfMatch[1];
          }
        }
        const simpleMatch = /filename="?([^";]+)"?/i.exec(contentDisposition);
        if (simpleMatch && simpleMatch[1]) {
          return simpleMatch[1];
        }
      }
      return DESKTOP_FILENAME_FALLBACKS[platformKey] || 'desktop-installer.bin';
    }

    async function handleDesktopBuild(button, platformKey) {
      if (!platformKey) return;
      const label = (DESKTOP_PLATFORM_LABELS[platformKey] || platformKey).trim();
      const originalText = button.dataset.originalLabel || button.textContent.trim();
      button.dataset.originalLabel = originalText;

      setDesktopStatus(`Building ${label}â€¦`, 'pending');
      button.disabled = true;
      button.textContent = 'Buildingâ€¦';

      try {
        const response = await fetchAdmin('/api/v1/desktop/build', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ platform: platformKey }),
        });

        if (response.status === 401) {
          setDesktopStatus('Admin authentication required to build installers.', 'error');
          return;
        }
        if (response.status === 403) {
          setDesktopStatus('Current account has no permission to build installers.', 'error');
          return;
        }
        if (!response.ok) {
          let detail = '';
          try {
            const data = await response.clone().json();
            detail = data?.detail || '';
          } catch {
            try {
              detail = await response.text();
            } catch {
              detail = '';
            }
          }
          setDesktopStatus(detail || `Desktop build failed (HTTP ${response.status}).`, 'error');
          return;
        }

        const blob = await response.blob();
        const filename = extractDownloadFilename(
          response.headers.get('content-disposition'),
          platformKey,
        );
        const url = URL.createObjectURL(blob);
        const tempLink = document.createElement('a');
        tempLink.href = url;
        tempLink.download = filename;
        document.body.appendChild(tempLink);
        tempLink.click();
        tempLink.remove();
        setTimeout(() => URL.revokeObjectURL(url), 2000);

        setDesktopStatus(`${label} ready â€” download should start automatically.`, 'success');
      } catch (error) {
        if (error && error.code === AUTH_CANCELLED_CODE) {
          setDesktopStatus('Build cancelled â€” admin login required.', 'error');
          return;
        }
        console.error('desktop build failed', error);
        setDesktopStatus('Desktop build failed â€” check server logs for details.', 'error');
      } finally {
        button.disabled = false;
        button.textContent = originalText || 'Download';
      }
    }

    async function handleAuthSubmit(event) {
      event?.preventDefault?.();
      if (!authForm) return;
      const username = (authUserInput?.value || '').trim();
      const password = authPasswordInput?.value || '';
      if (!username || !password) {
        setAuthErrorKey('authErrorMissing');
        if (!username) authUserInput?.focus();
        else authPasswordInput?.focus();
        return;
      }

      const header = `Basic ${btoa(`${username}:${password}`)}`;
      setAuthSubmitting(true);
      const result = await verifyAdminCredentials(authModalBase, header);
      setAuthSubmitting(false);

      if (!result.ok) {
        if (result.status === 401) {
          setAuthErrorKey('authErrorInvalid');
          if (authPasswordInput) {
            authPasswordInput.value = '';
            authPasswordInput.focus();
          }
        } else {
          setAuthErrorKey('authErrorNetwork');
        }
        return;
      }

      setAuthHeaderForBase(authModalBase, header);
      setStoredAdminUser(username);
      if (authPasswordInput) authPasswordInput.value = '';
      hideAuthModal();
      if (authModalResolver) authModalResolver(true);
    }

    if (authForm) {
      authForm.addEventListener('submit', handleAuthSubmit);
    }

    if (authCancelBtn) {
      authCancelBtn.addEventListener('click', (event) => {
        event.preventDefault();
        cancelAuthModal();
      });
    }

    if (authModal) {
      authModal.addEventListener('click', (event) => {
        if (event.target === authModal || event.target.classList.contains('auth-backdrop')) {
          event.preventDefault();
          cancelAuthModal();
        }
      });
    }

    function populateLanguageOptions() {
      if (!languageSelect) return;
      languageSelect.innerHTML = '';
      Object.entries(LANGUAGES).forEach(([code, cfg]) => {
        const option = document.createElement('option');
        option.value = code;
        option.textContent = cfg.name;
        languageSelect.appendChild(option);
      });
      languageSelect.value = currentLanguage;
    }

    function normalizeBaseUrl(value) {
      const fallback = window.location.origin.replace(/\/$/, '');
      if (!value) return fallback;
      let candidate = String(value).trim();
      if (!candidate) return fallback;
      if (!/^https?:\/\//i.test(candidate)) {
        try {
          candidate = new URL(candidate, window.location.origin).href;
        } catch {
          return fallback;
        }
      }
      try {
        const parsed = new URL(candidate);
        return parsed.origin.replace(/\/$/, '');
      } catch {
        return fallback;
      }
    }

    function populateVoiceOptions() {
      if (!avatarVoiceList || typeof window === 'undefined' || typeof window.speechSynthesis === 'undefined') {
        return;
      }
      const voices = window.speechSynthesis.getVoices();
      if (!voices || !voices.length) {
        if (!voiceOptionsPending) {
          voiceOptionsPending = true;
          setTimeout(() => {
            voiceOptionsPending = false;
            populateVoiceOptions();
          }, 600);
        }
        return;
      }
      voiceOptionsPending = false;
      const unique = new Set();
      avatarVoiceList.innerHTML = '';
      voices
        .slice()
        .sort((a, b) => {
          const langDiff = (a.lang || '').localeCompare(b.lang || '');
          return langDiff !== 0 ? langDiff : (a.name || '').localeCompare(b.name || '');
        })
        .forEach((voice) => {
          const name = (voice.name || '').trim();
          if (!name || unique.has(name)) return;
          unique.add(name);
          const option = document.createElement('option');
          option.value = name;
          const lang = (voice.lang || '').trim();
          option.label = lang ? `${name} â€” ${lang}` : name;
          avatarVoiceList.appendChild(option);
        });
      try {
        const stored = localStorage.getItem(VOICE_STORAGE_KEY);
        if (stored && avatarVoiceInput && !avatarVoiceInput.value) {
          avatarVoiceInput.value = stored;
        }
      } catch { }
    }

    function initVoiceOptions() {
      populateVoiceOptions();
      if (typeof window !== 'undefined' && window.speechSynthesis) {
        const register = () => populateVoiceOptions();
        if (typeof window.speechSynthesis.addEventListener === 'function') {
          window.speechSynthesis.addEventListener('voiceschanged', register);
        } else {
          const previous = window.speechSynthesis.onvoiceschanged;
          window.speechSynthesis.onvoiceschanged = (...args) => {
            populateVoiceOptions();
            if (typeof previous === 'function') previous.apply(window.speechSynthesis, args);
          };
        }
      }
      if (avatarVoiceInput) {
        try {
          const stored = localStorage.getItem(VOICE_STORAGE_KEY);
          if (stored) avatarVoiceInput.value = stored;
        } catch { }
      }
    }

    function initSpeechRateControl() {
      if (!speechRateInput) return;
      try {
        const stored = localStorage.getItem(SPEECH_RATE_STORAGE_KEY);
        if (stored) {
          speechRateInput.value = stored;
        }
      } catch { }
      updateSpeechRateDisplay();
      const applyRate = () => {
        const value = getSpeechRateValue();
        if (speechRateInput) {
          speechRateInput.value = value.toFixed(2);
        }
        updateSpeechRateDisplay();
        try {
          localStorage.setItem(SPEECH_RATE_STORAGE_KEY, value.toFixed(2));
        } catch { }
        if (currentVoicePreviewInstance?.setSpeechRate) {
          currentVoicePreviewInstance.setSpeechRate(value);
        }
        refreshVoiceSnippet();
      };
      speechRateInput.addEventListener('input', applyRate);
      speechRateInput.addEventListener('change', applyRate);
      if (voiceTestBtn) {
        voiceTestBtn.disabled = selectedVoiceMode === 'text' || !currentVoicePreviewInstance;
        voiceTestBtn.addEventListener('click', (event) => {
          event.preventDefault();
          const text = (voiceTestTextarea?.value || '').trim();
          if (!text) {
            voiceTestTextarea?.focus();
            return;
          }
          if (!currentVoicePreviewInstance?.speakTest || !currentVoicePreviewInstance.speakTest(text)) {
            console.warn('Voice preview is unavailable for the current mode.');
          }
        });
      }
    }

    function openFeedbackPanel() {
      if (!feedbackPanel) return;
      feedbackPanel.classList.add('show');
      if (feedbackStatus) feedbackStatus.textContent = '';
      if (feedbackMessageInput) {
        feedbackMessageInput.focus();
        feedbackMessageInput.select?.();
      }
    }

    function closeFeedbackPanel() {
      if (!feedbackPanel) return;
      feedbackPanel.classList.remove('show');
    }

    async function submitFeedback(event) {
      event.preventDefault();
      if (!feedbackSubmitBtn) return;
      const message = (feedbackMessageInput?.value || '').trim();
      if (!message) {
        if (feedbackStatus) feedbackStatus.textContent = t('feedbackError');
        return;
      }
      const baseCfg = getEmbedConfig();
      const baseUrl = baseCfg.baseUrl || window.location.origin;
      const payload = {
        message,
        name: (feedbackNameInput?.value || '').trim() || null,
        contact: (feedbackContactInput?.value || '').trim() || null,
        page: window.location.href,
        project: currentProject || null,
        source: isEmbed ? 'embed' : 'demo',
      };
      feedbackSubmitBtn.disabled = true;
      const originalText = feedbackSubmitBtn.textContent;
      feedbackSubmitBtn.textContent = t('feedbackSending');
      if (feedbackStatus) feedbackStatus.textContent = '';
      try {
        const resp = await fetch(`${baseUrl}/api/v1/feedback`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(payload),
          cache: 'no-store',
        });
        if (!resp.ok) throw new Error(`HTTP ${resp.status}`);
        feedbackMessageInput.value = '';
        if (feedbackStatus) feedbackStatus.textContent = t('feedbackSuccess');
      } catch (error) {
        console.error('feedback_submit_failed', error);
        if (feedbackStatus) feedbackStatus.textContent = t('feedbackError');
      } finally {
        feedbackSubmitBtn.disabled = false;
        feedbackSubmitBtn.textContent = originalText || t('feedbackSend');
      }
    }

    function initFeedbackWidget() {
      if (!feedbackTrigger || isEmbed) {
        if (feedbackTrigger) feedbackTrigger.style.display = 'none';
        if (feedbackPanel) feedbackPanel.style.display = 'none';
        return;
      }
      feedbackTrigger.addEventListener('click', () => {
        if (feedbackPanel?.classList.contains('show')) {
          closeFeedbackPanel();
        } else {
          openFeedbackPanel();
        }
      });
      feedbackCloseBtn?.addEventListener('click', closeFeedbackPanel);
      feedbackForm?.addEventListener('submit', submitFeedback);
      document.addEventListener('keydown', (event) => {
        if (event.key === 'Escape' && feedbackPanel?.classList.contains('show')) {
          closeFeedbackPanel();
        }
      });
    }

    function normalizePosition(value) {
      const normalized = (value || '').toLowerCase();
      return FLOATING_POSITIONS.includes(normalized) ? normalized : 'bottom-right';
    }

    function applyDemoLauncherPosition(position) {
      const normalized = normalizePosition(position);
      if (widgetLauncher) {
        widgetLauncher.dataset.position = normalized;
        widgetLauncher.classList.remove('pos-bottom-right', 'pos-bottom-left', 'pos-top-right', 'pos-top-left');
        widgetLauncher.classList.add(`pos-${normalized}`);
      }
      if (embedPositionPreview) {
        embedPositionPreview.dataset.position = normalized;
      }
      if (embedPositionMarker) {
        embedPositionMarker.dataset.position = normalized;
      }
      embedPositionButtons.forEach((button) => {
        button.dataset.active = button.dataset.positionOption === normalized ? 'true' : 'false';
      });
    }

    function setEmbedPosition(position, options = {}) {
      const normalized = normalizePosition(position);
      if (embedPositionInput) {
        embedPositionInput.value = normalized;
      }
      applyDemoLauncherPosition(normalized);
      if (!options.silent) {
        refreshEmbedSnippet();
        refreshVoiceSnippet();
      }
    }

    function getEmbedConfig() {
      const base = normalizeBaseUrl(embedBaseInput?.value || baseUrlInput?.value || window.location.origin);
      const project = (embedProjectInput?.value || currentProject || '').trim();
      const accent = (embedAccentInput?.value || '#4f7cff').trim() || '#4f7cff';
      const theme = (embedThemeSelect?.value || '').trim();
      const reading = !!embedReadingInput?.checked;
      const position = normalizePosition(embedPositionInput?.value || 'bottom-right');
      return { baseUrl: base, project, accent, theme, reading, position };
    }

    function getSpeechRateValue() {
      const raw = parseFloat(speechRateInput?.value || '1');
      if (!Number.isFinite(raw)) return 1;
      return Math.min(2, Math.max(0.5, raw));
    }

    function updateSpeechRateDisplay() {
      if (!speechRateDisplay) return;
      const rate = getSpeechRateValue();
      speechRateDisplay.textContent = `Ã—${rate.toFixed(2)}`;
    }

    function getVoiceConfig() {
      const core = getEmbedConfig();
      const lang = (avatarLangInput?.value || 'ru-RU').trim() || 'ru-RU';
      const voice = (avatarVoiceInput?.value || '').trim();
      const mode = selectedVoiceMode;
      const avatarCharacter = mode === 'avatar' ? (selectedAvatarCharacter || 'luna') : '';
      const speechRate = getSpeechRateValue();
      return { ...core, lang, voice, mode, avatarCharacter, speechRate };
    }

    function indentAttributes(attrs) {
      return attrs.filter(Boolean).map((line) => `  ${line}`).join('\n');
    }

    function buildFloatingSnippet(cfg) {
      const attrs = [
        `src="${cfg.baseUrl}/widget/widget-loader.js"`,
        `data-base-url="${cfg.baseUrl}"`,
        cfg.project ? `data-project="${cfg.project}"` : '',
        `data-variant="floating"`,
        `data-title="${t('launcherTitle')}"`,
        `data-subtitle="${t('launcherSubtitle')}"`,
        `data-icon="AI"`,
        `data-color="${cfg.accent}"`,
        cfg.theme ? `data-theme="${cfg.theme}"` : '',
        cfg.reading ? 'data-reading-mode="1"' : '',
        cfg.position ? `data-position="${cfg.position}"` : ''
      ];
      return `<script\n${indentAttributes(attrs)}\n><\/script>`;
    }

    function buildInlineSnippet(cfg) {
      const attrs = [
        `src="${cfg.baseUrl}/widget/widget-loader.js"`,
        `data-base-url="${cfg.baseUrl}"`,
        cfg.project ? `data-project="${cfg.project}"` : '',
        `data-variant="inline"`,
        `data-width="100%"`,
        `data-height="520px"`,
        `data-title="${t('launcherTitle')}"`,
        `data-subtitle="${t('launcherSubtitle')}"`,
        `data-color="${cfg.accent}"`,
        cfg.theme ? `data-theme="${cfg.theme}"` : '',
        cfg.reading ? 'data-reading-mode="1"' : ''
      ];
      return `<script\n${indentAttributes(attrs)}\n><\/script>`;
    }

    function buildIframeSnippet(cfg) {
      const params = new URLSearchParams({ embed: '1' });
      if (cfg.project) params.set('project', cfg.project);
      if (cfg.theme) params.set('theme', cfg.theme);
      if (cfg.reading) params.set('reading', '1');
      const src = `${cfg.baseUrl}/widget/index.html?${params.toString()}`;
      return `<iframe\n  src="${src}"\n  style="width:100%; min-height:640px; border:none; border-radius:18px; box-shadow:0 22px 48px rgba(15, 23, 42, 0.35);"\n  allow="microphone; clipboard-read; clipboard-write;"\n></iframe>`;
    }

    function buildVoiceSnippet(cfg) {
      const attrs = [
        `src="${cfg.baseUrl}/widget/voice-avatar.js"`,
        `data-base-url="${cfg.baseUrl}"`,
        cfg.project ? `data-project="${cfg.project}"` : '',
        `data-mode="${cfg.mode || 'voice'}"`,
        `data-lang="${cfg.lang}"`,
        cfg.voice ? `data-voice="${cfg.voice}"` : '',
        cfg.voiceModel ? `data-voice-model="${cfg.voiceModel}"` : '',
        Math.abs((cfg.speechRate ?? 1) - 1) > 0.001 ? `data-speech-rate="${Number(cfg.speechRate).toFixed(2)}"` : '',
        `data-label="AI"`,
        `data-headline="${t('chatTitle')}"`,
        `data-subtitle="${t('chatSubtitle')}"`,
        `data-color="${cfg.accent}"`,
        cfg.reading ? 'data-reading-mode="1"' : '',
        cfg.mode === 'avatar' ? 'data-avatar-animated="1"' : '',
        cfg.mode === 'avatar' && cfg.avatarCharacter ? `data-avatar-character="${cfg.avatarCharacter}"` : ''
      ];
      return `<script\n${indentAttributes(attrs)}\n><\/script>`;
    }

    function translateVoiceMessage(key, params) {
      let text = t(key);
      if (params && typeof params.model === 'string') {
        text = text.replace('{model}', params.model);
      }
      return text;
    }

    function renderVoiceHint() {
      if (!voiceFeatureHint) return;
      if (selectedVoiceMode === 'text') {
        let message = t('avatarHintTextMode');
        voiceFeatureHint.textContent = widgetReadingMode || pageReadingMode
          ? `${message} ${t('avatarHintReadingMode')}`
          : message;
        return;
      }
      let key = 'avatarHintSelectProject';
      let params = null;
      switch (voiceHintState.status) {
        case 'loading':
          key = 'avatarHintLoading';
          break;
        case 'disabled':
          key = 'avatarHintDisabled';
          break;
        case 'error':
          key = 'avatarHintError';
          break;
        case 'enabled-model':
          key = 'avatarHintEnabledModel';
          params = { model: voiceHintState.model || '' };
          break;
        case 'enabled':
          key = 'avatarHintEnabled';
          break;
        case 'select':
        default:
          key = 'avatarHintSelectProject';
      }
      if (selectedVoiceMode === 'avatar' && key === 'avatarHintEnabled') {
        key = 'avatarHintAvatarMode';
      }
      let text = translateVoiceMessage(key, params);
      if (selectedVoiceMode === 'avatar' && key !== 'avatarHintAvatarMode') {
        text = `${text} ${t('avatarHintAvatarAppend')}`;
      }
      if (widgetReadingMode || pageReadingMode) {
        text = `${text} ${t('avatarHintReadingMode')}`;
      }
      voiceFeatureHint.textContent = text;
    }

    function setVoiceHint(status, model) {
      voiceHintState.status = status;
      voiceHintState.model = model || null;
      renderVoiceHint();
    }

    function applyVoiceModeUi() {
      const mode = selectedVoiceMode;
      avatarModeOptions.forEach((option) => {
        const value = (option.dataset.modeOption || '').toLowerCase();
        const isActive = value === mode;
        option.classList.toggle('is-active', isActive);
        const radio = option.querySelector('input[type="radio"]');
        if (radio) {
          radio.checked = isActive;
        }
      });
      const disableVoice = mode === 'text';
      if (avatarLangInput) {
        avatarLangInput.disabled = disableVoice;
      }
      if (avatarVoiceInput) {
        avatarVoiceInput.disabled = disableVoice;
      }
      if (voiceGridEl) {
        voiceGridEl.classList.toggle('is-disabled', disableVoice);
      }
      if (speechRateInput) {
        speechRateInput.disabled = disableVoice;
      }
      if (speechRateDisplay) {
        speechRateDisplay.style.opacity = disableVoice ? '0.4' : '1';
      }
      if (voiceTestTextarea) {
        voiceTestTextarea.disabled = disableVoice;
      }
      if (voiceTestBtn) {
        voiceTestBtn.disabled = disableVoice || !currentVoicePreviewInstance;
      }
      updateSpeechRateDisplay();
      const showCharacters = mode === 'avatar';
      if (showCharacters && !selectedAvatarCharacter) {
        selectedAvatarCharacter = 'luna';
      }
      if (avatarCharacterPanel) {
        avatarCharacterPanel.hidden = !showCharacters;
      }
      avatarCharacterCards.forEach((card) => {
        const value = (card.dataset.avatarOption || '').toLowerCase();
        const isActive = showCharacters && (value === selectedAvatarCharacter || (!selectedAvatarCharacter && value === 'luna'));
        card.classList.toggle('is-active', isActive);
        card.disabled = !showCharacters;
        card.setAttribute('aria-pressed', isActive ? 'true' : 'false');
      });
    }

    function setVoiceMode(mode, options = {}) {
      const normalized = typeof mode === 'string' ? mode.trim().toLowerCase() : '';
      const allowed = normalized === 'text' || normalized === 'avatar' ? normalized : 'voice';
      selectedVoiceMode = allowed;
      applyVoiceModeUi();
      if (!options.skipHint) {
        renderVoiceHint();
      }
      if (!options.skipRefresh) {
        refreshVoiceSnippet();
      }
    }

    document.addEventListener('sitellm-voice-avatar-ready', (event) => {
      const detail = event.detail || null;
      if (!detail) return;
      currentVoicePreviewInstance = detail;
      if (currentVoicePreviewInstance.setSpeechRate) {
        currentVoicePreviewInstance.setSpeechRate(getSpeechRateValue());
      }
      applyVoiceModeUi();
    });

    document.addEventListener('sitellm-voice-avatar-destroyed', (event) => {
      if (event.detail && event.detail === currentVoicePreviewInstance) {
        currentVoicePreviewInstance = null;
        applyVoiceModeUi();
      }
    });

    function renderVoicePlaceholderFromState() {
      if (!voiceAvatarHost || !voicePlaceholderState.key) return;
      const wrapper = document.createElement('div');
      wrapper.className = 'voice-preview-placeholder';
      wrapper.textContent = translateVoiceMessage(voicePlaceholderState.key, voicePlaceholderState.params);
      voiceAvatarHost.innerHTML = '';
      voiceAvatarHost.appendChild(wrapper);
    }

    function showVoicePlaceholder(key, params = null) {
      voicePlaceholderState = { key, params };
      renderVoicePlaceholderFromState();
    }

    function setVoiceSnippetText() {
      if (!avatarCodeEl) return;
      const cfg = getVoiceConfig();
      const key = `${cfg.baseUrl}|${cfg.project || '__default__'}`;
      const voiceModel = key === remoteVoiceState.key ? remoteVoiceState.model : null;
      avatarCodeEl.textContent = buildVoiceSnippet({ ...cfg, voiceModel });
    }

    function scheduleVoicePreviewUpdate() {
      if (isEmbed) return;
      clearTimeout(voiceRenderTimer);
      voiceRenderTimer = setTimeout(() => {
        updateVoicePreview().catch((error) => console.error(error));
      }, 180);
    }

    async function fetchVoiceConfig(baseUrl, project) {
      const normalizedBase = normalizeBaseUrl(baseUrl);
      const cacheKey = `${normalizedBase}|${project || '__default__'}`;
      if (voiceConfigCache.has(cacheKey)) {
        return voiceConfigCache.get(cacheKey);
      }
      const promise = (async () => {
        if (!project) {
          return { enabled: true, model: null };
        }
        const url = `${normalizedBase}/api/v1/llm/project-config?project=${encodeURIComponent(project)}`;
        const resp = await fetch(url, { mode: 'cors' });
        if (!resp.ok) {
          throw new Error(`HTTP ${resp.status}`);
        }
        const data = await resp.json();
        return {
          enabled: data.llm_voice_enabled !== false,
          model: data.llm_voice_model || null,
        };
      })()
        .catch((error) => {
          voiceConfigCache.delete(cacheKey);
          throw error;
        });
      voiceConfigCache.set(cacheKey, promise);
      return promise;
    }

    async function updateVoicePreview() {
      if (isEmbed || !voiceAvatarHost) return;
      const cfg = getVoiceConfig();
      const normalizedBase = normalizeBaseUrl(cfg.baseUrl);
      const stateKey = `${normalizedBase}|${cfg.project || '__default__'}`;
      voicePreviewToken += 1;
      const token = voicePreviewToken;

      if (!cfg.project) {
        remoteVoiceState = { key: stateKey, enabled: true, model: null };
        showVoicePlaceholder('avatarPreviewSelect');
        setVoiceHint('select');
        setVoiceSnippetText();
        if (avatarCopyBtn) avatarCopyBtn.disabled = true;
        return;
      }

      setVoiceHint('loading');
      showVoicePlaceholder('avatarHintLoading');
      if (avatarCopyBtn) avatarCopyBtn.disabled = true;

      try {
        const remote = await fetchVoiceConfig(normalizedBase, cfg.project);
        if (token !== voicePreviewToken) return;
        remoteVoiceState = { key: stateKey, enabled: remote.enabled, model: remote.model };
        setVoiceSnippetText();
        const voiceAllowed = remote.enabled || selectedVoiceMode === 'text';
        if (!voiceAllowed) {
          showVoicePlaceholder('avatarHintDisabled');
          setVoiceHint('disabled');
          if (avatarCopyBtn) avatarCopyBtn.disabled = true;
          return;
        }
        const hintStatus = remote.enabled && remote.model ? 'enabled-model' : 'enabled';
        setVoiceHint(hintStatus, remote.enabled ? remote.model : null);
        if (avatarCopyBtn) avatarCopyBtn.disabled = false;
        voicePlaceholderState = { key: null, params: null };
        renderVoiceAvatarDemo({ ...cfg, voiceModel: remote.enabled ? remote.model : null });
      } catch (error) {
        if (token !== voicePreviewToken) return;
        console.error(error);
        remoteVoiceState = { key: stateKey, enabled: true, model: null };
        setVoiceSnippetText();
        showVoicePlaceholder('avatarHintError');
        setVoiceHint('error');
        if (avatarCopyBtn) {
          avatarCopyBtn.disabled = selectedVoiceMode !== 'text';
        }
      }
    }

    function setEmbedActiveTab(key) {
      activeEmbedVariant = key;
      embedTabs.forEach((tab) => {
        const variant = tab.dataset.embedTab || '';
        if (variant === key) {
          tab.classList.add('active');
          tab.setAttribute('aria-selected', 'true');
        } else {
          tab.classList.remove('active');
          tab.setAttribute('aria-selected', 'false');
        }
      });
    }

    function refreshEmbedSnippet() {
      if (!embedCodeEl) return;
      const cfg = getEmbedConfig();
      widgetReadingMode = !!cfg.reading;
      applyDemoLauncherPosition(cfg.position);
      let snippet = '';
      if (activeEmbedVariant === 'inline') snippet = buildInlineSnippet(cfg);
      else if (activeEmbedVariant === 'iframe') snippet = buildIframeSnippet(cfg);
      else snippet = buildFloatingSnippet(cfg);
      embedCodeEl.textContent = snippet;
    }

    function refreshVoiceSnippet() {
      setVoiceSnippetText();
      if (isEmbed) return;
      scheduleVoicePreviewUpdate();
    }

    function renderVoiceAvatarDemo(cfgOverride) {
      if (isEmbed || !voiceAvatarHost) return;
      const cfg = cfgOverride || getVoiceConfig();
      voicePlaceholderState = { key: null, params: null };
      if (currentVoicePreviewInstance && typeof currentVoicePreviewInstance.destroy === 'function') {
        try {
          currentVoicePreviewInstance.destroy();
        } catch (err) {
          console.warn('[SiteLLM voice-avatar] teardown failed', err);
        }
        currentVoicePreviewInstance = null;
      }
      voiceAvatarHost.innerHTML = '';
      const script = document.createElement('script');
      const cacheBuster = Date.now().toString(36);
      script.src = `voice-avatar.js?v=${cacheBuster}`;
      script.dataset.baseUrl = cfg.baseUrl;
      if (cfg.project) script.dataset.project = cfg.project;
      script.dataset.lang = cfg.lang;
      script.dataset.mode = cfg.mode || 'voice';
      if (cfg.voice) script.dataset.voice = cfg.voice;
      if (cfg.voiceModel) script.dataset.voiceModel = cfg.voiceModel;
      if (cfg.speechRate) script.dataset.speechRate = String(cfg.speechRate);
      if (cfg.reading) script.dataset.readingMode = '1';
      if (cfg.mode === 'avatar') {
        script.dataset.avatarAnimated = '1';
        if (cfg.avatarCharacter) {
          script.dataset.avatarCharacter = cfg.avatarCharacter;
        }
      }
      script.dataset.label = 'AI';
      script.dataset.headline = t('chatTitle');
      script.dataset.subtitle = t('chatSubtitle');
      script.dataset.color = cfg.accent;
      voiceAvatarHost.appendChild(script);
    }

    async function copySnippet(text, button) {
      if (!button || !text) return;
      const key = button.dataset.i18n || '';
      try {
        if (navigator.clipboard && navigator.clipboard.writeText) {
          await navigator.clipboard.writeText(text);
        } else {
          throw new Error('Clipboard API unavailable');
        }
      } catch {
        const helper = document.createElement('textarea');
        helper.value = text;
        helper.style.position = 'fixed';
        helper.style.opacity = '0';
        helper.style.pointerEvents = 'none';
        document.body.appendChild(helper);
        helper.focus();
        helper.select();
        try { document.execCommand('copy'); } catch { }
        document.body.removeChild(helper);
      }
      button.classList.add('copied');
      button.textContent = t('copiedLabel');
      setTimeout(() => {
        button.classList.remove('copied');
        if (key) button.textContent = t(key);
      }, 2000);
    }

    function initEmbedShowcase() {
      if (!embedBaseInput) return;
      const inferredBase = baseUrlInput?.value?.trim() || window.location.origin;
      embedBaseInput.value = normalizeBaseUrl(inferredBase || window.location.origin);
      if (embedProjectInput && currentProject) embedProjectInput.value = currentProject;
      if (embedAccentInput && !embedAccentInput.value) embedAccentInput.value = '#4f7cff';
      if (embedReadingInput) embedReadingInput.checked = pageReadingMode;
      if (embedPositionInput && !embedPositionInput.value) embedPositionInput.value = 'bottom-right';

      setEmbedActiveTab(activeEmbedVariant);

      embedTabs.forEach((tab) => {
        tab.addEventListener('click', () => {
          const variant = tab.dataset.embedTab || 'floating';
          setEmbedActiveTab(variant);
          refreshEmbedSnippet();
        });
      });

      const handleEmbedChange = () => {
        refreshEmbedSnippet();
        refreshVoiceSnippet();
      };

      [embedBaseInput, embedProjectInput, embedAccentInput, embedReadingInput].forEach((input) => {
        input?.addEventListener('input', handleEmbedChange);
      });
      embedThemeSelect?.addEventListener('change', handleEmbedChange);
      embedPositionButtons.forEach((button) => {
        button.addEventListener('click', () => {
          const targetPosition = button.dataset.positionOption;
          setEmbedPosition(targetPosition);
        });
      });

      setEmbedPosition(embedPositionInput?.value || 'bottom-right', { silent: true });
      avatarLangInput?.addEventListener('input', () => refreshVoiceSnippet());
      const handleVoiceInput = () => {
        const value = (avatarVoiceInput?.value || '').trim();
        try {
          if (value) {
            localStorage.setItem(VOICE_STORAGE_KEY, value);
          } else {
            localStorage.removeItem(VOICE_STORAGE_KEY);
          }
        } catch { }
        refreshVoiceSnippet();
      };
      avatarVoiceInput?.addEventListener('input', handleVoiceInput);
      avatarVoiceInput?.addEventListener('change', handleVoiceInput);
      avatarModeInputs.forEach((input) => {
        input?.addEventListener('change', () => {
          if (input.checked) {
            setVoiceMode(input.value);
          }
        });
      });
      avatarCharacterCards.forEach((card) => {
        card?.addEventListener('click', () => {
          if (card.disabled) return;
          const value = (card.dataset.avatarOption || '').toLowerCase();
          if (!value) return;
          selectedAvatarCharacter = value;
          applyVoiceModeUi();
          refreshVoiceSnippet();
        });
      });

      if (embedCopyBtn) {
        embedCopyBtn.addEventListener('click', () => {
          copySnippet(embedCodeEl?.textContent || '', embedCopyBtn);
        });
      }
      if (avatarCopyBtn) {
        avatarCopyBtn.addEventListener('click', () => {
          copySnippet(avatarCodeEl?.textContent || '', avatarCopyBtn);
        });
      }

      applyVoiceModeUi();
      renderVoiceHint();
      initSpeechRateControl();
      initVoiceOptions();
      refreshEmbedSnippet();
      refreshVoiceSnippet();
    }

    function applyLanguage(lang) {
      if (!LANGUAGES[lang]) lang = FALLBACK_LANGUAGE;
      currentLanguage = lang;
      try { localStorage.setItem(LANGUAGE_STORAGE_KEY, currentLanguage); } catch { }
      const cfg = LANGUAGES[currentLanguage];
      document.documentElement.lang = currentLanguage;
      document.documentElement.dir = cfg.dir || 'ltr';
      if (languageSelect) {
        languageSelect.value = currentLanguage;
      }

      document.querySelectorAll('[data-i18n]').forEach((node) => {
        const key = node.dataset.i18n;
        node.textContent = t(key);
      });

      document.querySelectorAll('[data-i18n-placeholder]').forEach((node) => {
        const key = node.dataset.i18nPlaceholder;
        node.setAttribute('placeholder', t(key));
      });

      document.querySelectorAll('[data-i18n-aria-label]').forEach((node) => {
        const key = node.dataset.i18nAriaLabel;
        node.setAttribute('aria-label', t(key));
      });

      if (authHint) {
        const hostValue = authHint.dataset.host || computeAuthHost(getCurrentBaseValue());
        authHint.dataset.host = hostValue;
        authHint.textContent = t('authHint').replace('{host}', hostValue);
      }

      if (authError && authError.dataset.key) {
        authError.textContent = t(authError.dataset.key);
      }

      if (healthText) {
        const statusKey = healthText.dataset.statusKey || 'unknown';
        healthText.textContent = translateStatus(statusKey);
      }

      if (debugHint) {
        debugHint.textContent = debugCheckbox.checked ? t('debugHintOn') : t('debugHintOff');
      }

      if (projectInfo) {
        projectInfo.textContent = currentProject ? t('projectInfoSelected').replace('{project}', currentProject) : t('projectInfoNone');
      }

      if (hintSend) hintSend.textContent = t('inputHintSend');
      if (hintNewline) hintNewline.textContent = t('inputHintNewline');
      if (clearLink) clearLink.textContent = t('clearLink');

      if (banner && banner.dataset.active !== 'true' && bannerText) {
        bannerText.textContent = t('bannerConnectionError');
      }

      document.querySelectorAll('[data-role-key]').forEach((node) => {
        node.textContent = translateRole(node.dataset.roleKey);
      });

      if (chatModal) {
        chatModal.dataset.demoTitle = t('chatPreviewTitle');
      }

      if (embedCopyBtn) {
        embedCopyBtn.classList.remove('copied');
        const key = embedCopyBtn.dataset.i18n || 'embedCopy';
        embedCopyBtn.textContent = t(key);
      }
      if (avatarCopyBtn) {
        avatarCopyBtn.classList.remove('copied');
        const key = avatarCopyBtn.dataset.i18n || 'avatarCopy';
        avatarCopyBtn.textContent = t(key);
      }

      renderVoiceHint();
      renderVoicePlaceholderFromState();
      refreshEmbedSnippet();
      refreshVoiceSnippet();
    }

    if (languageSelect) {
      populateLanguageOptions();
      languageSelect.addEventListener('change', (event) => {
        applyLanguage(event.target.value);
      });
    }

    applyLanguage(currentLanguage);
    initEmbedShowcase();
    initFeedbackWidget();

    if (heroDemoBtn) {
      heroDemoBtn.addEventListener('click', () => {
        if (chatModal) {
          chatModal.scrollIntoView({ behavior: 'smooth', block: 'start' });
          setTimeout(() => { input?.focus(); }, 300);
        }
      });
    }


    const SESSION_STORAGE_KEY = 'chat_session_base';
    let currentSessionBase = (() => {
      try {
        const stored = localStorage.getItem(SESSION_STORAGE_KEY) || '';
        return stored.trim().toLowerCase();
      } catch {
        return '';
      }
    })();

    function generateSessionId() {
      try {
        if (window.crypto && typeof window.crypto.randomUUID === 'function') {
          return window.crypto.randomUUID().toLowerCase();
        }
      } catch { }
      const suffix = Math.random().toString(36).slice(2, 10);
      return `${Date.now().toString(36)}${suffix}`.toLowerCase();
    }

    function ensureSessionId() {
      if (currentSessionBase) return currentSessionBase;
      currentSessionBase = generateSessionId();
      try { localStorage.setItem(SESSION_STORAGE_KEY, currentSessionBase); } catch { }
      return currentSessionBase;
    }

    function updateSessionBase(sessionValue) {
      if (!sessionValue) return;
      let base = String(sessionValue);
      if (base.includes('::')) {
        const parts = base.split('::');
        base = parts[parts.length - 1] || parts[0];
      }
      base = base.trim().toLowerCase();
      if (!base || base === currentSessionBase) return;
      currentSessionBase = base;
      try { localStorage.setItem(SESSION_STORAGE_KEY, currentSessionBase); } catch { }
    }

    let currentES = null;
    let streaming = false;
    let tokenChars = 0;
    let streamingMessageEl = null;
    let projectsCache = [];

    if (isEmbed) {
      document.body.classList.add('embed');
    }

    function openChat() {
      chatModal.classList.add('open');
      chatBackdrop.classList.add('open');
      setTimeout(() => { input?.focus(); }, 150);
    }

    function closeChat() {
      if (!document.body.classList.contains('embed')) return;
      chatModal.classList.remove('open');
      chatBackdrop.classList.remove('open');
    }

    if (widgetLauncher) widgetLauncher.addEventListener('click', openChat);
    if (chatClose) chatClose.addEventListener('click', closeChat);
    if (chatBackdrop) chatBackdrop.addEventListener('click', closeChat);
    document.addEventListener('keydown', (evt) => {
      if (evt.key === 'Escape') {
        if (authModal?.dataset.visible === 'true') {
          evt.preventDefault();
          cancelAuthModal();
          return;
        }
        closeChat();
      }
    });

    // Load saved base URL
    baseUrlInput.value = localStorage.getItem('chat_base_url') || '';

    function setTheme(theme) {
      const next = theme === 'light' ? 'light' : 'dark';
      document.documentElement.dataset.theme = next;
      try { localStorage.setItem('chat_theme', next); } catch { }
    }

    function toggleTheme() {
      const current = document.documentElement.dataset.theme || 'dark';
      setTheme(current === 'dark' ? 'light' : 'dark');
    }

    themeToggle.addEventListener('click', toggleTheme);

    function setHealth(ok, statusKey) {
      healthDot.classList.remove('ok', 'bad');
      if (ok === true) healthDot.classList.add('ok');
      else if (ok === false) healthDot.classList.add('bad');
      const key = typeof statusKey === 'string' && statusKey ? statusKey : 'unknown';
      if (healthText) {
        healthText.dataset.statusKey = key;
        healthText.textContent = translateStatus(key);
      }
    }

    async function pingHealth() {
      const base = baseUrlInput.value.trim();
      const url = base ? `${base.replace(/\/$/, '')}/health` : '/health';
      try {
        const resp = await fetch(url);
        if (!resp.ok) throw new Error(`HTTP ${resp.status}`);
        const data = await resp.json();
        const message = data?.status || 'ok';
        setHealth(true, message);
      } catch (error) {
        console.error(error);
        setHealth(false, 'offline');
      }
    }

    function saveConfig() {
      const base = baseUrlInput.value.trim();
      try { localStorage.setItem('chat_base_url', base); } catch { }
      if (embedBaseInput) {
        embedBaseInput.value = normalizeBaseUrl(base || window.location.origin);
        refreshEmbedSnippet();
        refreshVoiceSnippet();
      }
      pingHealth();
    }

    saveCfgBtn.addEventListener('click', saveConfig);

    const SESSION_KEY = 'chat_session_id';
    let currentSession = localStorage.getItem(SESSION_KEY) || '';

    function ensureSession() {
      if (!currentSession) {
        currentSession = `${ensureSessionId()}::${generateSessionId()}`;
        try { localStorage.setItem(SESSION_KEY, currentSession); } catch { }
      }
      return currentSession;
    }

    function newSession() {
      currentSession = `${ensureSessionId()}::${generateSessionId()}`;
      try { localStorage.setItem(SESSION_KEY, currentSession); } catch { }
      return currentSession;
    }

    function appendMessage(text, role = 'assistant', meta = {}) {
      const wrapper = document.createElement('div');
      wrapper.className = `msg ${role}`;
      const head = document.createElement('div');
      head.className = 'role';
      const t = new Date();
      const hh = String(t.getHours()).padStart(2, '0');
      const mm = String(t.getMinutes()).padStart(2, '0');
      const roleSpan = document.createElement('span');
      roleSpan.dataset.roleKey = role;
      roleSpan.textContent = translateRole(role);
      const timeSpan = document.createElement('span');
      timeSpan.className = 'time';
      timeSpan.textContent = `${hh}:${mm}`;
      head.appendChild(roleSpan);
      head.appendChild(timeSpan);
      wrapper.appendChild(head);
      const body = document.createElement('div');
      body.className = 'msg-body';
      let displayText = text;
      if ((!displayText || !String(displayText).trim()) && Array.isArray(meta.sources) && meta.sources.length) {
        displayText = t('sourcesTitle');
      }
      body.textContent = displayText || '';
      wrapper.appendChild(body);
      if (meta.attachments?.length) {
        const attachmentsRoot = document.createElement('div');
        attachmentsRoot.className = 'msg-attachments';
        meta.attachments.forEach((att) => {
          const attEl = document.createElement('div');
          attEl.className = 'attachment-item';
          if (att.content_type?.startsWith('image/')) {
            attEl.classList.add('attachment-image');
            const img = document.createElement('img');
            img.src = att.url;
            img.alt = att.description || att.name || t('attachmentLabel');
            attEl.appendChild(img);
            if (att.description) {
              const caption = document.createElement('div');
              caption.className = 'attachment-caption';
              caption.textContent = att.description;
              attEl.appendChild(caption);
            }
          } else {
            attEl.classList.add('attachment-file');
            const link = document.createElement('a');
            link.href = att.url;
            link.target = '_blank';
            link.rel = 'noopener';
            link.textContent = att.name || t('attachmentLabel');
            attEl.appendChild(link);
            if (att.description) {
              const caption = document.createElement('div');
              caption.className = 'attachment-caption';
              caption.textContent = att.description;
              attEl.appendChild(caption);
            }
          }
          attachmentsRoot.appendChild(attEl);
        });
        wrapper.appendChild(attachmentsRoot);
      }
      if (Array.isArray(meta.sources) && meta.sources.length) {
        const sourcesRoot = document.createElement('div');
        sourcesRoot.className = 'msg-sources';
        const list = document.createElement('div');
        list.className = 'msg-sources-list';
        meta.sources.forEach((entry, index) => {
          if (!entry || !entry.url) return;
          const link = document.createElement('a');
          link.href = entry.url;
          link.target = '_blank';
          link.rel = 'noopener';
          link.textContent = entry.name || entry.url;
          link.dataset.index = String(index + 1);
          list.appendChild(link);
        });
        if (list.children.length) {
          sourcesRoot.appendChild(list);
          wrapper.appendChild(sourcesRoot);
        }
      }
      messages.appendChild(wrapper);
      messages.scrollTo({ top: messages.scrollHeight, behavior: 'smooth' });
      return wrapper;
    }

    function addSystemMessage(text) {
      appendMessage(text, 'system');
    }

    function clearMessages() {
      messages.innerHTML = '';
      try { localStorage.removeItem('chat_history'); } catch { }
    }

    clearLink.addEventListener('click', (event) => {
      event.preventDefault();
      clearMessages();
    });

    function saveHistory() {
      try {
        localStorage.setItem('chat_history', messages.innerHTML);
      } catch { }
    }

    (function restoreHistory() {
      try {
        const history = localStorage.getItem('chat_history');
        if (history) {
          messages.innerHTML = history;
          applyLanguage(currentLanguage);
        }
      } catch { }
    })();

    function setStreamingState(value) {
      streaming = Boolean(value);
      stopBtn.disabled = !streaming;
      sendBtn.disabled = streaming;
      input.readOnly = streaming;
    }

    async function loadProjects() {
      try {
        const resp = await fetchAdmin('/api/v1/admin/projects/names');
        if (resp.status === 401) {
          bannerError(t('errorAuthRequired'));
          return;
        }
        if (!resp.ok) throw new Error(`HTTP ${resp.status}`);
        const data = await resp.json();
        let items = data.projects || [];
        if (!Array.isArray(items)) items = [];
        projectsCache = items;
        if (projectSelect) {
          projectSelect.innerHTML = '';
          projectsCache.forEach((name) => {
            const option = document.createElement('option');
            option.value = name;
            option.textContent = name;
            projectSelect.appendChild(option);
          });
        }
        if (currentProject && projectsCache.includes(currentProject)) {
          projectSelect.value = currentProject;
        } else if (projectsCache.length) {
          currentProject = projectsCache[0];
          if (projectSelect) projectSelect.value = currentProject;
        }
        updateProjectInfo();
      } catch (error) {
        if (error && error.code === AUTH_CANCELLED_CODE) {
          return;
        }
        console.error(error);
        bannerError(t('errorLoadProjects'));
      }
    }

    function updateProjectInfo() {
      const selected = projectSelect.value || '';
      currentProject = selected;
      try { localStorage.setItem('chat_project', currentProject); } catch { }
      if (projectInfo) {
        projectInfo.textContent = currentProject ? t('projectInfoSelected').replace('{project}', currentProject) : t('projectInfoNone');
      }
      if (embedProjectInput) {
        embedProjectInput.value = currentProject;
        refreshEmbedSnippet();
        refreshVoiceSnippet();
      }
    }

    projectSelect.addEventListener('change', () => {
      updateProjectInfo();
    });
    refreshProjectsBtn.addEventListener('click', loadProjects);

    debugCheckbox.addEventListener('change', () => {
      const hint = debugCheckbox.checked ? t('debugHintOn') : t('debugHintOff');
      debugHint.textContent = hint;
    });

    savePromptBtn.addEventListener('click', async () => {
      if (!currentProject) {
        promptStatus.textContent = t('projectInfoNone');
        return;
      }
      const path = `/api/v1/admin/projects/${encodeURIComponent(currentProject)}`;
      const payload = {
        name: currentProject,
        llm_prompt: startPromptInput.value,
      };
      promptStatus.textContent = t('statusSaving');
      try {
        const resp = await fetchAdmin(path, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(payload),
        });
        if (resp.status === 401) {
          promptStatus.textContent = t('errorAuthRequired');
          return;
        }
        if (!resp.ok) throw new Error(`HTTP ${resp.status}`);
        promptStatus.textContent = t('statusSaved');
        setTimeout(() => (promptStatus.textContent = ''), 3000);
      } catch (error) {
        if (error && error.code === AUTH_CANCELLED_CODE) {
          promptStatus.textContent = '';
          return;
        }
        console.error(error);
        promptStatus.textContent = t('statusError');
      }
    });

    function bannerError(message) {
      banner.dataset.active = 'true';
      bannerText.textContent = message || t('bannerConnectionError');
      banner.style.display = 'block';
    }

    bannerClose.addEventListener('click', () => {
      banner.style.display = 'none';
      banner.dataset.active = 'false';
      bannerText.textContent = t('bannerConnectionError');
    });

    async function sendQuestion(question) {
      const base = baseUrlInput.value.trim();
      const endpointBase = base ? base.replace(/\/$/, '') : '';
      const params = new URLSearchParams();
      params.set('question', question);
      if (currentProject) params.set('project', currentProject);
      const sessionId = ensureSession();
      params.set('session_id', sessionId);
      if (debugCheckbox.checked) params.set('debug', '1');
      if (widgetReadingMode || pageReadingMode) params.set('reading', '1');
      const url = `${endpointBase || ''}/api/v1/llm/chat?${params.toString()}`;

      if (currentES) {
        currentES.close();
        currentES = null;
      }

      const chunks = [];
      tokenChars = 0;
      streamingMessageEl = null;
      setStreamingState(true);

      try {
        currentES = new EventSource(url, { withCredentials: false });
      } catch (error) {
        bannerError(t('errorNoSSE'));
        setStreamingState(false);
        return;
      }

      currentES.addEventListener('message', (event) => {
        try {
          const data = JSON.parse(event.data);
          if (typeof data?.text === 'string') {
            chunks.push(data.text);
            tokenChars += data.text.length;
            if (!streamingMessageEl) {
              streamingMessageEl = appendMessage('', data.role || 'assistant', data.meta || {});
            }
            const body = streamingMessageEl?.querySelector('.msg-body');
            if (body) {
              body.textContent += data.text;
            }
            saveHistory();
          }
          if (data?.meta?.session_id) {
            updateSessionBase(data.meta.session_id);
          }
        } catch (error) {
          console.error('stream parse error', error, event.data);
        }
      });

      currentES.addEventListener('meta', (event) => {
        try {
          const meta = JSON.parse(event.data);
          if (meta?.session_id) {
            updateSessionBase(meta.session_id);
          }
        } catch (error) {
          console.error('meta parse error', error, event.data);
        }
      });

      currentES.addEventListener('debug', (event) => {
        if (!debugCheckbox.checked) return;
        try {
          const data = JSON.parse(event.data);
          appendMessage(JSON.stringify(data, null, 2), 'debug');
          saveHistory();
        } catch (error) {
          console.error('debug parse error', error);
        }
      });

      currentES.addEventListener('sources', (event) => {
        try {
          const data = JSON.parse(event.data);
          const entries = Array.isArray(data?.entries) ? data.entries : [];
          if (!entries.length) return;
          appendMessage('', 'assistant', { sources: entries });
          saveHistory();
        } catch (error) {
          console.error('sources parse error', error, event.data);
        }
      });

      currentES.addEventListener('attachment', (event) => {
        try {
          const data = JSON.parse(event.data);
          appendMessage(data.description || data.name || t('attachmentLabel'), 'assistant', { attachments: [data] });
          saveHistory();
        } catch (error) {
          console.error('attachment parse error', error);
        }
      });

      currentES.addEventListener('end', () => {
        setStreamingState(false);
        currentES?.close();
      });

      currentES.addEventListener('error', (event) => {
        console.error('sse error', event);
        bannerError(t('errorStreaming'));
        setStreamingState(false);
        currentES?.close();
        streamingMessageEl = null;
      });
    }

    form.addEventListener('submit', async (event) => {
      event.preventDefault();
      if (isEmbed && !chatModal.classList.contains('open')) {
        openChat();
      }
      const question = input.value.trim();
      if (!question) return;
      appendMessage(question, 'user');
      saveHistory();
      input.value = '';
      sendBtn.disabled = true;
      try {
        await sendQuestion(question);
      } finally {
        sendBtn.disabled = false;
      }
    });

    stopBtn.addEventListener('click', () => {
      if (
        currentES &&
        typeof currentES.close === 'function'
      ) {
        currentES.close();
      }
      setStreamingState(false);
      streamingMessageEl = null;
    });

    saveCfgBtn.addEventListener('click', saveConfig);

    setTheme(localStorage.getItem('chat_theme') || 'dark');

    window.addEventListener('load', () => {
      ensureSessionId();
      if (!isEmbed) {
        chatModal.classList.add('open');
      }
      loadProjects().finally(() => {
        if (currentProject) {
          projectSelect.value = currentProject;
          updateProjectInfo();
        }
      });
      pingHealth();
      setInterval(pingHealth, 15000);
    });
  </script>
</body>

</html>