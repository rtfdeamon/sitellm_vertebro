<!--
  Lightweight chat widget demonstrating SSE streaming from /api/v1/llm/chat.
  Copy this file into another app and change the EventSource URL as needed.
-->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>LLM Chat Widget</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 1rem; }
    #messages { border: 1px solid #ccc; padding: 0.5rem; height: 200px; overflow-y: auto; margin-bottom: 1rem; }
    .user { color: #0057b8; }
    .assistant { color: #008000; }
    form { display: flex; gap: 0.5rem; }
    input[type=text] { flex: 1; padding: 0.5rem; }
  </style>
</head>
<body>
  <div id="messages"></div>
  <form id="chat-form">
    <input type="text" id="question" placeholder="Ask a question" autocomplete="off" />
    <button type="submit">Send</button>
  </form>
<script>
const form = document.getElementById('chat-form');
const input = document.getElementById('question');
const messages = document.getElementById('messages');

form.addEventListener('submit', function(e) {
  e.preventDefault();
  const question = input.value.trim();
  if (!question) return;
  const userDiv = document.createElement('div');
  userDiv.className = 'user';
  userDiv.textContent = question;
  messages.appendChild(userDiv);
  input.value = '';

  const answerDiv = document.createElement('div');
  answerDiv.className = 'assistant';
  messages.appendChild(answerDiv);

  const es = new EventSource(`/api/v1/llm/chat?question=${encodeURIComponent(question)}`);
  es.onmessage = (event) => {
    answerDiv.textContent += event.data;
    messages.scrollTop = messages.scrollHeight;
  };
  es.onerror = () => {
    es.close();
  };
});
</script>
</body>
</html>
